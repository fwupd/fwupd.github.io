<!--
SPDX-FileCopyrightText: fwupd Development Team

SPDX-License-Identifier: LGPL-2.1-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>FwupdPlugin &ndash; 1.0: Plugin: MTD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="org.freedesktop.fwupd.svg"/>
  <meta property="og:image:alt" content="FwupdPlugin-1.0"/>
  

  
  <meta property="og:title" content="FwupdPlugin: Plugin: MTD"/>
  <meta property="og:description" content="Reference for FwupdPlugin-1.0: Plugin: MTD"/>
  <meta name="twitter:title" content="FwupdPlugin: Plugin: MTD"/>
  <meta name="twitter:description" content="Reference for FwupdPlugin-1.0: Plugin: MTD"/>


  
  <meta name="twitter:card" content="summary"/>

  
  
  
  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap_fwupdplugin.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>

  
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <a href="index.html"><img src="org.freedesktop.fwupd.svg" class="logo"/></a>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">FwupdPlugin</a></h3>
        <p>API Version: 1.0</p>
        
        <p>Library Version: 2.0.2</p>
        
      </div>
      
      
      <div class="section generator">
        <p>Generated by <a href="https://gitlab.gnome.org/GNOME/gi-docgen">gi-docgen</a> 2024.1</p>
      </div>
    </nav>

    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  
  <h4 id="title" style="display:flex;">
    Plugin: MTD
    <a href="#title" class="anchor"></a>
    
  </h4>
  
  <section>
    <div class="docblock">
    <h2 id="introduction">Introduction<a class="md-anchor" href="#introduction" title="Permanent link"></a></h2>
<p>The Memory Technology Device (<span class="caps">MTD</span>) interface is a way of abstracting flash devices as if they were
normal block&nbsp;devices.</p>
<p>See <a href="http://www.linux-mtd.infradead.org/doc/general.html">http://www.linux-mtd.infradead.org/doc/general.html</a> for more&nbsp;details.</p>
<p>This plugin supports the following protocol <span class="caps">ID</span>:</p>
<ul>
<li><code>org.infradead.mtd</code></li>
</ul>
<h2 id="guid-generation">GUID Generation<a class="md-anchor" href="#guid-generation" title="Permanent link"></a></h2>
<p>These devices use custom DeviceInstanceId values built from the device <code>NAME</code> and <span class="caps">DMI</span> data,&nbsp;e.g.</p>
<ul>
<li><code>MTD\NAME_Factory</code></li>
<li><code>MTD\VENDOR_foo&amp;NAME_baz</code></li>
<li><code>MTD\VENDOR_foo&amp;PRODUCT_bar&amp;NAME_baz</code></li>
</ul>
<p>If the <code>FirmwareGType</code> quirk is set for the device then the firmware is read back from the device at
daemon startup and parsed for the version number.
In the event the firmware has multiple child images then the device GUIDs are used as firmware&nbsp;IDs.</p>
<h2 id="update-behavior">Update Behavior<a class="md-anchor" href="#update-behavior" title="Permanent link"></a></h2>
<p>The <span class="caps">MTD</span> device is erased in chunks, written and then read back to&nbsp;verify.</p>
<p>Although fwupd can read and write a raw image to the <span class="caps">MTD</span> partition there is no automatic way to
get the <em>existing</em> version number. By providing the <code>GType</code> fwupd can read the <span class="caps">MTD</span> partition and
discover additional metadata about the image. For instance, adding a quirk&nbsp;like:</p>
<div class="codehilite"><pre><span></span><code>[MTD\VENDOR_PINE64&amp;PRODUCT_PinePhone-Pro&amp;NAME_spi1.0]
FirmwareGType = FuUswidFirmware
</code></pre></div>

<p>&#8230; and then append or insert the image into the <span class="caps">MTD</span> image with prepared <span class="caps">SBOM</span>&nbsp;metadata:</p>
<div class="codehilite"><pre><span></span><code>pip install uswid
uswid --load uswid.ini --save metadata.uswid
</code></pre></div>

<p>This would allow fwupd to read the <span class="caps">MTD</span> image data, look for a <a href="https://github.com/hughsie/python-uswid">uSWID</a>
data section and then parse the metadata from that. Any of the firmware formats supported by
<code>fwupdtool get-firmware-gtypes</code> that can provide a version can be&nbsp;used.</p>
<h2 id="quirk-use">Quirk Use<a class="md-anchor" href="#quirk-use" title="Permanent link"></a></h2>
<p>This plugin uses the following plugin-specific&nbsp;quirks:</p>
<h3 id="mtdmetadataoffset">MtdMetadataOffset<a class="md-anchor" href="#mtdmetadataoffset" title="Permanent link"></a></h3>
<p>The offset to start searching within the <span class="caps">MTD</span> partition when using <code>FirmwareGType</code>. This is provided
to avoid dumping a huge amount of <span class="caps">MTD</span> data to access a tiny chunk of data that will not be before a
known&nbsp;offset.</p>
<p>Since:&nbsp;1.9.1</p>
<h3 id="mtdmetadatasize">MtdMetadataSize<a class="md-anchor" href="#mtdmetadatasize" title="Permanent link"></a></h3>
<p>The size of data to read from the <span class="caps">MTD</span> partition when using <code>FirmwareGType</code>. This is provided to
avoid dumping a huge amount of <span class="caps">MTD</span> data to access a tiny chunk of&nbsp;data.</p>
<p>Since:&nbsp;1.9.1</p>
<h2 id="vendor-id-security">Vendor ID Security<a class="md-anchor" href="#vendor-id-security" title="Permanent link"></a></h2>
<p>The vendor <span class="caps">ID</span> is set from the system vendor, for example <code>DMI:LENOVO</code></p>
<h2 id="external-interface-access">External Interface Access<a class="md-anchor" href="#external-interface-access" title="Permanent link"></a></h2>
<p>This plugin requires read/write access to <code>/dev/mtd</code>.</p>
<h2 id="version-considerations">Version Considerations<a class="md-anchor" href="#version-considerations" title="Permanent link"></a></h2>
<p>This plugin has been available since fwupd version <code>1.7.2</code>.</p>
    </div>
  </section>
</section>


    
<div id="toc" class="toc">
  <nav aria-labelledby="toc-title">
    <p id="toc-title">Content</p>
    <ul class="toc-list">
      
        
        <li class="toc-list-item"><a href="#introduction"><span class="link-text">Introduction</span></a></li>
          
        
        <li class="toc-list-item"><a href="#guid-generation"><span class="link-text">GUID Generation</span></a></li>
          
        
        <li class="toc-list-item"><a href="#update-behavior"><span class="link-text">Update Behavior</span></a></li>
          
        
        <li class="toc-list-item"><a href="#quirk-use"><span class="link-text">Quirk Use</span></a></li>
          
          <ul class="toc-list">
          
            <li class="toc-list-item"><a href="#mtdmetadataoffset"><span class="link-text">MtdMetadataOffset</span></a></li>
          
            <li class="toc-list-item"><a href="#mtdmetadatasize"><span class="link-text">MtdMetadataSize</span></a></li>
          
          </ul>
          
        
        <li class="toc-list-item"><a href="#vendor-id-security"><span class="link-text">Vendor ID Security</span></a></li>
          
        
        <li class="toc-list-item"><a href="#external-interface-access"><span class="link-text">External Interface Access</span></a></li>
          
        
        <li class="toc-list-item"><a href="#version-considerations"><span class="link-text">Version Considerations</span></a></li>
          
        
      
    </ul>
  </nav>
</div>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>