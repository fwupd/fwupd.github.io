<!--
SPDX-FileCopyrightText: 2021 GNOME Foundation

SPDX-License-Identifier: Apache-2.0 OR GPL-3.0-or-later
-->

<!--
SPDX-FileCopyrightText: 2021 GNOME Foundation

SPDX-License-Identifier: Apache-2.0 OR GPL-3.0-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>FwupdPlugin &ndash; 1.0: Host Security ID Specification</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="org.freedesktop.fwupd.svg"/>
  <meta property="og:image:alt" content="FwupdPlugin-1.0"/>
  

  
  <meta property="og:title" content="FwupdPlugin: Host Security ID Specification"/>
  <meta property="og:description" content="Reference for FwupdPlugin-1.0: Host Security ID Specification"/>
  <meta name="twitter:title" content="FwupdPlugin: Host Security ID Specification"/>
  <meta name="twitter:description" content="Reference for FwupdPlugin-1.0: Host Security ID Specification"/>


  
  <meta name="twitter:card" content="summary"/>

  
  
  
  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap_fwupdplugin.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <img src="org.freedesktop.fwupd.svg" class="logo"/>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">FwupdPlugin</a></h3>
        <p>API Version: 1.0</p>
        
        <p>Library Version: 1.8.7</p>
        
      </div>
      
      
    </nav>
    
    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  <section>
    <div class="docblock">
    <p><strong><span class="caps">WARNING</span>:
This specification is still in active development: it is incomplete, subject to change, and may have errors; use this at your own risk.
It is based on publicly available&nbsp;information.</strong></p>
<p>Authors:</p>
<ul>
<li>Richard&nbsp;Hughes</li>
<li>Mario&nbsp;Limonciello</li>
<li>Alex&nbsp;Bazhaniuk</li>
<li>Alex&nbsp;Matrosov</li>
</ul>
<hr />
<h2 id="introduction">Introduction<a class="md-anchor" href="#introduction" title="Permanent link"></a></h2>
<p>Not all system vendors prioritize building a secure platform.
The truth is that <strong>security costs money</strong>.
Vendors have to choose between saving a few cents on a bill-of-materials by sharing a <span class="caps">SPI</span> chip, or correctly implementing BootGuard.
Discovering security vulnerabilities often takes an external researcher filing a disclosure.
These disclosures are often technical in nature and difficult for an average consumer to&nbsp;decipher.</p>
<p>The Linux Vendor Firmware Service (<span class="caps">LVFS</span>) could provide some <strong>easy-to-understand</strong> information to people buying hardware.
The service already knows a huge amount of information about machines from signed reports uploaded to the <span class="caps">LVFS</span> and from analyzing firmware binaries.
However this information alone does not explain firmware security to the user in a way they can actually&nbsp;interpret.</p>
<h3 id="other-tools">Other Tools<a class="md-anchor" href="#other-tools" title="Permanent link"></a></h3>
<p>Traditionally, figuring out the true security of your hardware and firmware requires sifting through the marketing documentation provided by the <span class="caps">OEM</span> and in many cases just &#8220;trusting&#8221; they did it right.
Tools such as Chipsec can check the hardware configuration, but they do not work out of the box and use technical jargon that an average user cannot interpret.
Unfortunately, running a tool like Chipsec requires that you actively turn off some security layers such as <span class="caps">UEFI</span> Secure Boot, and allow 3rd party unsigned kernel modules to be&nbsp;loaded.</p>
<p><a id="verifying"></a></p>
<h2 id="verifying-host-firmware-security"><a href="#verifying">Verifying Host Firmware Security</a><a class="md-anchor" href="#verifying-host-firmware-security" title="Permanent link"></a></h2>
<p>To start out some core protections must be assigned a relative
importance.
Then an evaluation must be done to determine how each vendor is conforming to the model.
For instance, a user might say that for home use any hardware the bare minimum security level (<code>HSI:1</code>) is <em>good enough</em>.
For a work laptop the company <span class="caps">IT</span> department might restrict the choice of models to anything meeting the criteria of level <code>HSI:2</code> or above.
A journalist or a security researcher would only buy level <code>HSI:3</code> and above.
The reality is that <code>HSI:4</code> is going to be more expensive than some unbranded hardware that is rated <code>HSI:0</code>.</p>
<p>To be trusted, this rating information should be distributed in a centralized agnostic database such as the <span class="caps">LVFS</span>.</p>
<p>Of course, tools need to detect implementation errors, and to verify that the model that is measured does indeed match the <span class="caps">HSI</span> level advertised by the <span class="caps">LVFS</span>.
Some existing compliance solutions place the burden on the <span class="caps">OEM</span> to define what firmware security has been implemented, which is easy to get wrong and in some cases impossible to&nbsp;verify.</p>
<p>For this reason <span class="caps">HSI</span> will only measure security protections that can be verified by the end user without requiring any extra hardware to be connected, additional software to be installed, or disabling any existing security layers to&nbsp;measure.</p>
<p>The <span class="caps">HSI</span> specification is primarily designed for laptop and desktop hardware, although some tests <em>may</em> still make sense on server or embedded hardware.
It is not expected that non-consumer hardware will publish an <span class="caps">HSI</span>&nbsp;number.</p>
<p><a id="runtime-behaviour"></a></p>
<h2 id="runtime-behavior"><a href="#runtime-behaviour">Runtime Behavior</a><a class="md-anchor" href="#runtime-behavior" title="Permanent link"></a></h2>
<p>Orthogonal to the security features provided by the firmware there are other security considerations related to the firmware which may require internet access to discover or that runtime <span class="caps">OS</span> changes directly affect the security of the firmware.
It would not make sense to have <em>have updates on the <span class="caps">LVFS</span></em> as a requirement for a specific security level as this would mean offline the platform might be a higher level initially but as soon as it is brought online it is downgraded which would be really confusing to users.
The <em>core</em> security level will not change at Operating System runtime, but the suffix&nbsp;may.</p>
<p><strong>More information</strong>
Additional information about specific bugs and debugging steps are available on the <a href="https://github.com/fwupd/fwupd/wiki/Host-security-ID-runtime-issues">fwupd wiki</a>.</p>
<p><a id="hsi-level0"></a></p>
<h3 id="hsi0-insecure-state"><a href="#hsi-level0">HSI:0 (Insecure State)</a><a class="md-anchor" href="#hsi0-insecure-state" title="Permanent link"></a></h3>
<p>Limited firmware&nbsp;protection.</p>
<p>The lowest security level with little or no detected firmware protections.
This is the default security level if no tests can be run or some tests in the next security level have&nbsp;failed.</p>
<p><a id="hsi-level1"></a></p>
<h3 id="hsi1-critical-state"><a href="#hsi-level1">HSI:1 (Critical State)</a><a class="md-anchor" href="#hsi1-critical-state" title="Permanent link"></a></h3>
<p>Basic protection but any failure would lead to a critical security&nbsp;impact.</p>
<p>This security level corresponds to the most basic of security protections considered essential by security professionals.
Any failures at this level would have critical security impact and could likely be used to compromise the system firmware without physical&nbsp;access.</p>
<p><a id="hsi-level2"></a></p>
<h3 id="hsi2-risky-state"><a href="#hsi-level2">HSI:2 (Risky State)</a><a class="md-anchor" href="#hsi2-risky-state" title="Permanent link"></a></h3>
<p>The failure is only happened by the theoretical exploit in the&nbsp;lab.</p>
<p>This security level corresponds to firmware security issues that pose a theoretical concern or where any exploit would be difficult or impractical to use.
At this level various technologies may be employed to protect the boot process from modification by an attacker with local access to the&nbsp;machine.</p>
<p><a id="hsi-level3"></a></p>
<h3 id="hsi3-protected-state"><a href="#hsi-level3">HSI:3 (Protected State)</a><a class="md-anchor" href="#hsi3-protected-state" title="Permanent link"></a></h3>
<p>The system firmware only has few minor issues which do not affect the security&nbsp;status.</p>
<p>This security level corresponds to out-of-band protection of the system firmware perhaps including&nbsp;recovery.</p>
<p><a id="hsi-level4"></a></p>
<h3 id="hsi4-secure-state"><a href="#hsi-level4">HSI:4 (Secure State)</a><a class="md-anchor" href="#hsi4-secure-state" title="Permanent link"></a></h3>
<p>The system is in a robust secure&nbsp;state.</p>
<p>The system is corresponding several kind of encryption and execution protection for the system&nbsp;firmware.</p>
<p><a id="hsi-level5"></a></p>
<h3 id="hsi5-secure-proven-state"><a href="#hsi-level5">HSI:5 (Secure Proven State)</a><a class="md-anchor" href="#hsi5-secure-proven-state" title="Permanent link"></a></h3>
<p>This security level corresponds to out-of-band attestation of the system firmware.
There are currently no tests implemented for <span class="caps">HSI</span>:5 and so this security level cannot yet be&nbsp;obtained.</p>
<p><a id="runtime-bang"></a></p>
<h3 id="hsi-runtime-suffix"><a href="#runtime-bang">HSI Runtime Suffix <code>!</code></a><a class="md-anchor" href="#hsi-runtime-suffix" title="Permanent link"></a></h3>
<p>A runtime security issue&nbsp;detected.</p>
<ul>
<li>
<p><span class="caps">UEFI</span> <a href="https://wiki.ubuntu.com/UEFI/SecureBoot">Secure Boot</a> has been turned off. <em>[v1.5.0]</em></p>
</li>
<li>
<p>The kernel is <a href="https://www.kernel.org/doc/html/latest/admin-guide/tainted-kernels.html">tainted</a> due to a non-free module or critical firmware issue. <em>[v1.5.0]</em></p>
</li>
<li>
<p>The kernel is not <a href="https://mjg59.dreamwidth.org/50577.html">locked down</a>. <em>[v1.5.0]</em></p>
</li>
<li>
<p>Unencrypted <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Swap_encryption">swap partition</a>. <em>[v1.5.0]</em></p>
</li>
<li>
<p>The installed fwupd is running with <a href="https://github.com/fwupd/fwupd/tree/main/plugins">custom or modified plugins</a>. <em>[v1.5.0]</em></p>
</li>
</ul>
<p><a id="low-security-level"></a></p>
<h2 id="low-security-level"><a href="#low-security-level">Low Security Level</a><a class="md-anchor" href="#low-security-level" title="Permanent link"></a></h2>
<p>A safe baseline for security should be <span class="caps">HSI</span>-1. If your system isn&#8217;t at least meeting this criteria, you should adjust firmware setup options, contact your manufacturer or replace the&nbsp;hardware.</p>
<p>The command line tool <code>fwupdmgr security</code> included with fwupd 1.8.4 or later will make individual recommendations on what you can do for individual test failures.  <span class="caps">GUI</span> tools built against <code>libfwupd</code> 1.8.4 or later may also make these recommendation as&nbsp;well.</p>
<p><a id="not-enough-info"></a></p>
<h2 id="not-enough-information"><a href="#not-enough-info">Not enough information</a><a class="md-anchor" href="#not-enough-information" title="Permanent link"></a></h2>
<p><span class="caps">HSI</span> calculations require that the <span class="caps">SOC</span>, firmware, and kernel provide enough data to the fwupd daemon about the state of the system.  If any <span class="caps">HSI</span> test that runs on the system declares it&#8217;s <em>missing data</em> then the client will show a message like&nbsp;this:</p>
<p><strong>Not enough data was provided to make an <span class="caps">HSI</span>&nbsp;calculation.</strong></p>
<p>The <span class="caps">HSI</span> level will also be set to <code>INVALID</code> indicating&nbsp;this.</p>
<p><a id="tests"></a></p>
<h2 id="tests-included-in-fwupd"><a href="#tests">Tests included in fwupd</a><a class="md-anchor" href="#tests-included-in-fwupd" title="Permanent link"></a></h2>
<p>The set of tests is currently x86 <span class="caps">UEFI</span>-centric, but will be expanded in the future for various <span class="caps">ARM</span> or <span class="caps">RISC</span>-V firmware protections as required.
Where the requirement is architecture or processor specific it has been&nbsp;noted.</p>
<p><a id="org.fwupd.hsi.Amd.PlatformRollbackProtection"></a></p>
<h3 id="amd-rollback-protection"><a href="#org.fwupd.hsi.Amd.PlatformRollbackProtection">AMD Rollback protection</a><a class="md-anchor" href="#amd-rollback-protection" title="Permanent link"></a></h3>
<p><span class="caps">AMD</span> SOCs include the ability to prevent a rollback attack by a rollback protection feature on the&nbsp;firmware.</p>
<p>This feature prevents an attacker from loading an older firmware onto the part after a security vulnerability has been&nbsp;fixed.</p>
<p><strong>Impact:</strong></p>
<p>SOCs without this feature may be attacked by an attacker installing an older firmware that takes advantage of a well-known&nbsp;vulnerability.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-enabled</code>: rollback protection disabled&nbsp;(failure)</li>
<li><code>enabled</code>: rollback protection enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.8.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.psacertified.org/blog/anti-rollback-explained/">Rollback&nbsp;protection</a></li>
</ul>
<p><a id="org.fwupd.hsi.Amd.SpiReplayProtection"></a></p>
<h3 id="amd-spi-write-protections"><a href="#org.fwupd.hsi.Amd.SpiReplayProtection">AMD SPI Write protections</a><a class="md-anchor" href="#amd-spi-write-protections" title="Permanent link"></a></h3>
<p>SOCs may enforce control of the <span class="caps">SPI</span> bus to prevent writes other than by verified&nbsp;entities.</p>
<p><strong>Impact:</strong></p>
<p>SOCs without this feature may be attacked by an attacker modifying the <span class="caps">SPI</span>.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-enabled</code>: <span class="caps">SPI</span> protections disabled&nbsp;(failure)</li>
<li><code>enabled</code>: <span class="caps">SPI</span> protections enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.8.0]</em></p>
<p><a id="org.fwupd.hsi.Amd.SpiWriteProtection"></a></p>
<h3 id="amd-spi-replay-protections"><a href="#org.fwupd.hsi.Amd.SpiWriteProtection">AMD SPI Replay protections</a><a class="md-anchor" href="#amd-spi-replay-protections" title="Permanent link"></a></h3>
<p>SOCs may include support for replay-protected monotonic counters to prevent replay&nbsp;attacks.</p>
<p><strong>Impact:</strong></p>
<p>SOCs without this feature may be attacked by an attacker modifying the <span class="caps">SPI</span>.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-enabled</code>: <span class="caps">SPI</span> protections disabled&nbsp;(failure)</li>
<li><code>enabled</code>: <span class="caps">SPI</span> protections enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.8.0]</em></p>
<p><a id="org.fwupd.hsi.EncryptedRam"></a></p>
<h3 id="dram-memory-encryption"><a href="#org.fwupd.hsi.EncryptedRam">DRAM memory encryption</a><a class="md-anchor" href="#dram-memory-encryption" title="Permanent link"></a></h3>
<p><span class="caps">TME</span> (Intel) or <span class="caps">SME</span> (<span class="caps">AMD</span>) is used by the hardware on supported SOCs to encrypt all data on external memory&nbsp;buses.</p>
<p>It mitigates against an attacker being able to capture memory data while the system is running or to capture memory by removing a <span class="caps">DRAM</span>&nbsp;chip.</p>
<p>This encryption may be activated by either transparently via firmware configuration or by code running in the Linux&nbsp;kernel.</p>
<p><strong>Impact:</strong></p>
<p>A local attacker can either extract unencrypted content by attaching debug probes on the <span class="caps">DIMM</span> modules, or by removing them and inserting them into a computer with a modified <span class="caps">DRAM</span>&nbsp;controller.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-encrypted</code>: detected but disabled&nbsp;(failure)</li>
<li><code>not-supported</code>: not available&nbsp;(failure)</li>
<li><code>encrypted</code>: detected and enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-4 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://software.intel.com/content/www/us/en/develop/blogs/intel-releases-new-technology-specification-for-memory-encryption.html">Intel <span class="caps">TME</span> Press&nbsp;Release</a></li>
<li><a href="https://en.wikichip.org/wiki/x86/sme">WikiChip <span class="caps">SME</span>&nbsp;Overview</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelBootguard.Acm"></a></p>
<h3 id="intel-bootguard-acm"><a href="#org.fwupd.hsi.IntelBootguard.Acm">Intel BootGuard: ACM</a><a class="md-anchor" href="#intel-bootguard-acm" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system&nbsp;manufacturer.</p>
<p>It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong></p>
<p>When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be&nbsp;verified.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: boot is not verified&nbsp;(failure)</li>
<li><code>valid</code>: <span class="caps">ACM</span> protected&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelBootguard.Enabled"></a></p>
<p><a id="org.fwupd.hsi.Kernel.IntelBootguard"></a></p>
<h3 id="intel-bootguard-enabled"><a href="#org.fwupd.hsi.IntelBootguard.Enabled">Intel BootGuard: Enabled</a><a class="md-anchor" href="#intel-bootguard-enabled" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system&nbsp;manufacturer.</p>
<p>It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong></p>
<p>When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be&nbsp;verified.</p>
<p>This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-enabled</code>: not detected, or detected but not enabled&nbsp;(failure)</li>
<li><code>enabled</code>: detected and enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://github.com/coreboot/coreboot/blob/master/src/soc/intel/jasperlake/include/soc/me.h">Coreboot&nbsp;documentation</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelBootguard.Otp"></a></p>
<h3 id="intel-bootguard-otp"><a href="#org.fwupd.hsi.IntelBootguard.Otp">Intel BootGuard: OTP</a><a class="md-anchor" href="#intel-bootguard-otp" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system&nbsp;manufacturer.</p>
<p>It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong></p>
<p>When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be&nbsp;verified.</p>
<p>This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: <span class="caps">SOC</span> is not locked&nbsp;(failure)</li>
<li><code>valid</code>: <span class="caps">SOC</span> is locked&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelBootguard.Policy"></a></p>
<h3 id="intel-bootguard-policy"><a href="#org.fwupd.hsi.IntelBootguard.Policy">Intel BootGuard: Policy</a><a class="md-anchor" href="#intel-bootguard-policy" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system&nbsp;manufacturer.</p>
<p>It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong></p>
<p>The attacker can invalidate the chain of trust (subverting Secure Boot), and the user would get just a console warning and then continue to&nbsp;boot.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: policy is invalid&nbsp;(failure)</li>
<li><code>valid</code>: error enforce policy is set to shutdown&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelBootguard.Verified"></a></p>
<h3 id="intel-bootguard-verified"><a href="#org.fwupd.hsi.IntelBootguard.Verified">Intel BootGuard: Verified</a><a class="md-anchor" href="#intel-bootguard-verified" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system&nbsp;manufacturer.</p>
<p>It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong></p>
<p>When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be&nbsp;verified.</p>
<p>This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: boot is not verified&nbsp;(failure)</li>
<li><code>success</code>: verified boot chain&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelCet.Active"></a></p>
<h3 id="intel-cet-active"><a href="#org.fwupd.hsi.IntelCet.Active">Intel CET: Active</a><a class="md-anchor" href="#intel-cet-active" title="Permanent link"></a></h3>
<p>Control enforcement technology is available on new Intel platforms and prevents exploits from hijacking the control-flow transfer instructions for both forward-edge (indirect call/jmp) and back-edge transfer&nbsp;(ret).</p>
<p><strong>Impact:</strong></p>
<p>A local or physical attacker with an existing unrelated vulnerability can use a <span class="caps">ROP</span> gadget to run arbitrary&nbsp;code.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-supported</code>: <span class="caps">CET</span> not being used by the host&nbsp;(failure)</li>
<li><code>supported</code>: <span class="caps">CET</span> being used&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf">Intel <span class="caps">CET</span> Technology&nbsp;Preview</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelCet.Enabled"></a></p>
<h3 id="intel-cet-available"><a href="#org.fwupd.hsi.IntelCet.Enabled">Intel CET: Available</a><a class="md-anchor" href="#intel-cet-available" title="Permanent link"></a></h3>
<p>Control enforcement technology is available on new Intel platforms and prevents exploits from hijacking the control-flow transfer instructions for both forward-edge (indirect call/jmp) and back-edge transfer&nbsp;(ret).</p>
<p><strong>Impact:</strong></p>
<p>A local or physical attacker with an existing unrelated vulnerability can use a reliable and well-known method to run arbitrary&nbsp;code.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-supported</code>: <span class="caps">CET</span> not supported&nbsp;(failure)</li>
<li><code>enabled</code>: <span class="caps">CET</span> feature enabled by the platform&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf">Intel <span class="caps">CET</span> Technology&nbsp;Preview</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelSmap"></a></p>
<h3 id="intel-smap"><a href="#org.fwupd.hsi.IntelSmap">Intel SMAP</a><a class="md-anchor" href="#intel-smap" title="Permanent link"></a></h3>
<p>Without Supervisor Mode Access Prevention, the supervisor code usually has full read and write access to user-space memory&nbsp;mappings.</p>
<p>This can make exploits easier to write, as it allows the kernel to access user-space memory when it did not intend&nbsp;to.</p>
<p><strong>Impact:</strong></p>
<p>A local or remote attacker can use a simple exploit to modify the contents of kernel memory which can lead to privilege&nbsp;escalation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-supported</code>: <span class="caps">SMAP</span> not enabled&nbsp;(failure)</li>
<li><code>enabled</code>: <span class="caps">SMAP</span> features are detected and enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-4 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Supervisor_Mode_Access_Prevention"><span class="caps">SMAP</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Iommu"></a></p>
<h3 id="dma-protection"><a href="#org.fwupd.hsi.Iommu">DMA protection</a><a class="md-anchor" href="#dma-protection" title="Permanent link"></a></h3>
<p>The <span class="caps">IOMMU</span> on modern systems is used to mitigate against <span class="caps">DMA</span>&nbsp;attacks.</p>
<p>All I/O for devices capable of <span class="caps">DMA</span> is mapped into a private virtual memory&nbsp;region.</p>
<p>Common implementations are Intel <span class="caps">VT</span>-d and <span class="caps">AMD</span>-Vi.</p>
<p><strong>Impact:</strong></p>
<p>An attacker with inexpensive PCIe development hardware can write to system <span class="caps">RAM</span> from the ThunderBolt or Firewire ports which can lead to privilege&nbsp;escalation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: <span class="caps">IOMMU</span> hardware was not detected&nbsp;(failure)</li>
<li><code>enabled</code>: <span class="caps">IOMMU</span> hardware detected and enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>Resolution:</strong> If available, turn on <span class="caps">IOMMU</span> in the system <span class="caps">BIOS</span>. You may also have to use additional kernel boot parameters, for example <code>intel_iommu=on iommu=pt</code>.</p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Input%E2%80%93output_memory_management_unit"><span class="caps">IOMMU</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Kernel.Lockdown"></a></p>
<h3 id="kernel-lockdown"><a href="#org.fwupd.hsi.Kernel.Lockdown">Kernel Lockdown</a><a class="md-anchor" href="#kernel-lockdown" title="Permanent link"></a></h3>
<p>Kernel lockdown is an important mechanism to limit what hardware actions userspace programs can&nbsp;perform.</p>
<p>Turning on this feature means that often-used mechanisms like /dev/mem used to raise privileges or exfiltrate data are no longer&nbsp;available.</p>
<p><strong>Impact:</strong></p>
<p>An unlocked kernel can be easily abused by a malicious userspace program running as root, which can include replacing system&nbsp;firmware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: could not read lockdown status, perhaps from an old kernel&nbsp;(failure)</li>
<li><code>not-enabled</code>: lockdown is set to <code>none</code> (failure)</li>
<li><code>enabled</code>: lockdown is set to either <code>integrity</code> or <code>confidentiality</code>.&nbsp;(success)</li>
</ul>
<p><a id="org.fwupd.hsi.Kernel.Tainted"></a></p>
<h3 id="kernel-tainted"><a href="#org.fwupd.hsi.Kernel.Tainted">Kernel Tainted</a><a class="md-anchor" href="#kernel-tainted" title="Permanent link"></a></h3>
<p>When calculating the <span class="caps">HSI</span> value fwupd has to ask the Linux Kernel for&nbsp;information.</p>
<p>If the kernel has been tainted by overriding a firmware table or by loading a proprietary module then we cannot trust the data it&nbsp;reports.</p>
<p><strong>Impact:</strong></p>
<p>Using a tainted kernel means that values obtained from the kernel cannot be&nbsp;trusted.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: could not detect kernel taint status&nbsp;(failure)</li>
<li><code>tainted</code>: the kernel is untrusted, perhaps because a proprietary module was loaded&nbsp;(failure)</li>
<li><code>not-tainted</code>: the kernel is trusted&nbsp;(success)</li>
</ul>
<p><a id="org.fwupd.hsi.Mei.BootGuardPlatformKey"></a></p>
<h3 id="me-bootguard-platform-key"><a href="#org.fwupd.hsi.Mei.BootGuardPlatformKey">ME BootGuard Platform Key</a><a class="md-anchor" href="#me-bootguard-platform-key" title="Permanent link"></a></h3>
<p>The BootGuard Platform Key is fused into the <span class="caps">CPU</span> <span class="caps">PCH</span> during manufacturing by the <span class="caps">OEM</span>.</p>
<p>At bootup, an authenticated code module computes a hash of the Platform Key and and compares it with the one stored in field-programmable&nbsp;fuses.</p>
<p>If the key matches the <span class="caps">ACM</span> will pass control to the firmware, otherwise the boot process will&nbsp;stop.</p>
<p>In 2022 a number of Platform <strong>secret</strong> Keys were leaked by Lenovo and confirmed by&nbsp;Intel.</p>
<p><strong>Impact:</strong></p>
<p>A custom system firmware can be signed using the leaked private key to completely disable <span class="caps">UEFI</span> Secure Boot and allow complete persistent compromise of the affected&nbsp;machine.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: device uses a key that is compromised&nbsp;(failure)</li>
<li><code>valid</code>: device uses a BootGuard Platform Key that is not known to be compromised&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.8.7]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://github.com/phretor/intel-leak-checker/">Intel leak&nbsp;checker</a></li>
<li><a href="https://www.tomshardware.com/news/intel-confirms-6gb-alder-lake-bios-source-code-leak-new-details-emerge">Tom&#8217;s Hardware&nbsp;Article</a></li>
</ul>
<p><a id="org.fwupd.hsi.Mei.ManufacturingMode"></a></p>
<h3 id="me-not-in-manufacturing-mode"><a href="#org.fwupd.hsi.Mei.ManufacturingMode">ME not in manufacturing mode</a><a class="md-anchor" href="#me-not-in-manufacturing-mode" title="Permanent link"></a></h3>
<p>There have been some unfortunate cases of the <span class="caps">ME</span> being distributed in manufacturing&nbsp;mode.</p>
<p>In manufacturing mode many features from the <span class="caps">ME</span> can be interacted with that decrease the platform&#8217;s&nbsp;security.</p>
<p><strong>Impact:</strong></p>
<p>If the <span class="caps">ME</span> is in manufacturing mode then any user with root access can provision the <span class="caps">ME</span> engine with new&nbsp;keys.</p>
<p>This gives them full access to the system even when the system is powered&nbsp;off.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-locked</code>: device is in manufacturing mode&nbsp;(failure)</li>
<li><code>locked</code>: device has had manufacturing mode disabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://malware.news/t/intel-me-manufacturing-mode-obscured-dangers-and-their-relationship-to-apple-macbook-vulnerability-cve-2018-4251/23214"><span class="caps">ME</span> Manufacturing Mode: obscured&nbsp;dangers</a></li>
<li><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00086.html">Intel security advisory <span class="caps">SA</span>-00086</a></li>
</ul>
<p><a id="org.fwupd.hsi.Mei.OverrideStrap"></a></p>
<h3 id="me-flash-descriptor-override"><a href="#org.fwupd.hsi.Mei.OverrideStrap">ME Flash Descriptor Override</a><a class="md-anchor" href="#me-flash-descriptor-override" title="Permanent link"></a></h3>
<p>The Flash Descriptor Security Override Strap is not accessible to end users on consumer boards and Intel stresses that this is for debugging&nbsp;only.</p>
<p><strong>Impact:</strong></p>
<p>The system firmware can be written from userspace by changing the protected&nbsp;region.</p>
<p>This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-locked</code>: device is in debugging mode&nbsp;(failure)</li>
<li><code>locked</code>: device in in normal runtime mode&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://chromium.googlesource.com/chromiumos/third_party/flashrom/+/master/Documentation/mysteries_intel.txt">Chromium documentation for Intel <span class="caps">ME</span></a></li>
</ul>
<p><a id="org.fwupd.hsi.Mei.Version"></a></p>
<h3 id="csme-version"><a href="#org.fwupd.hsi.Mei.Version">CSME Version</a><a class="md-anchor" href="#csme-version" title="Permanent link"></a></h3>
<p>Converged Security and Manageability Engine is a standalone management module that can manage and control some local devices without the host <span class="caps">CPU</span>&nbsp;involvement.</p>
<p>The <span class="caps">CSME</span> lives in the <span class="caps">PCH</span> and can only be updated by the <span class="caps">OEM</span>&nbsp;vendor.</p>
<p>The version of the <span class="caps">CSME</span> module can be checked to detect the most common and serious&nbsp;vulnerabilities.</p>
<p><strong>Impact:</strong></p>
<p>Using any one of the critical vulnerabilities, a remote attacker can take full control of the system and all connected devices, even when the system is powered&nbsp;off.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: affected by one of the critical CVEs&nbsp;(failure)</li>
<li><code>valid</code>: is not affected by the most critical CVEs&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>Resolution:</strong> Update your Management Engine&nbsp;firmware</p>
<p><strong>Issues:</strong></p>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5705"><span class="caps">CVE</span>-2017-5705</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5706"><span class="caps">CVE</span>-2017-5706</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5707"><span class="caps">CVE</span>-2017-5707</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5708"><span class="caps">CVE</span>-2017-5708</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5709"><span class="caps">CVE</span>-2017-5709</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5710"><span class="caps">CVE</span>-2017-5710</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5711"><span class="caps">CVE</span>-2017-5711</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-5712"><span class="caps">CVE</span>-2017-5712</a></li>
</ul>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00086.html">Intel <span class="caps">CSME</span> Security Review Cumulative&nbsp;Update</a></li>
</ul>
<p><a id="org.fwupd.hsi.PlatformDebugEnabled"></a></p>
<p><a id="org.fwupd.hsi.IntelDci.Enabled"></a></p>
<h3 id="intel-dci"><a href="#org.fwupd.hsi.PlatformDebugEnabled">Intel DCI</a><a class="md-anchor" href="#intel-dci" title="Permanent link"></a></h3>
<p>Newer Intel CPUs support debugging over <span class="caps">USB3</span> via a proprietary Direct Connection Interface (<span class="caps">DCI</span>) with the use of off-the-shelf&nbsp;hardware.</p>
<p><strong>Impact:</strong></p>
<p>Using <span class="caps">DCI</span> an attacker with physical access to the computer has full access to all registers and memory in the system, and is able to make&nbsp;changes.</p>
<p>This makes privilege escalation from user to root possible, and also modifying <span class="caps">SMM</span> makes it possible to write to system firmware for a persistent&nbsp;backdoor.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: debugging is currently enabled&nbsp;(failure)</li>
<li><code>not-enabled</code>: debugging is not currently enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.co.uk/content/www/uk/en/support/articles/000029393/processors.html">Intel Direct Connect&nbsp;Interface</a></li>
<li><a href="https://github.com/chipsec/chipsec/blob/master/chipsec/cfg/8086/pch_4xxlp.xml#L270">Chipsec 4xxlp register&nbsp;definitions</a></li>
<li><a href="https://github.com/riscv/riscv-edk2-platforms/blob/85a50de1b459d1d6644a402081120770aa6dd8c7/Silicon/Intel/CoffeelakeSiliconPkg/Pch/Include/Register/PchRegsDci.h"><span class="caps">RISC</span>-V <span class="caps">EDK</span> <span class="caps">PCH</span> register&nbsp;definitions</a></li>
</ul>
<p><strong>More&nbsp;information:</strong></p>
<p>This attribute was previously known as <code>org.fwupd.hsi.IntelDci.Enabled</code> in 1.5.0, but was renamed in 1.8.0 to support other&nbsp;vendors.</p>
<p><a id="org.fwupd.hsi.PlatformDebugLocked"></a></p>
<p><a id="org.fwupd.hsi.IntelDci.Locked"></a></p>
<h3 id="part-is-debug-locked"><a href="#org.fwupd.hsi.PlatformDebugLocked">Part is debug locked</a><a class="md-anchor" href="#part-is-debug-locked" title="Permanent link"></a></h3>
<p>Some devices support a concept of whether a part has been unlocked for debugging using proprietary hardware. Such parts allow access to registers that are typically restricted when parts are&nbsp;fused.</p>
<p>On Intel systems access to this interface is done via a proprietary Direct Connection Interface (<span class="caps">DCI</span>).</p>
<p><strong>Impact:</strong></p>
<p>If using a debug unlocked part, the platform&#8217;s overall security will be decreased as an attacker may have elevated access to registers and memory within the system and can potentially enable persistent&nbsp;backdoors.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-locked</code>: device is not not locked&nbsp;(failure)</li>
<li><code>locked</code>: device is locked&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.8.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.co.uk/content/www/uk/en/support/articles/000029393/processors.html">Intel Direct Connect&nbsp;Interface</a></li>
</ul>
<p><a id="org.fwupd.hsi.PlatformFused"></a></p>
<h3 id="part-is-fused"><a href="#org.fwupd.hsi.PlatformFused">Part is fused</a><a class="md-anchor" href="#part-is-fused" title="Permanent link"></a></h3>
<p>When fuses are blown in parts from some manufacturers the hardware will enforce protections against tampering or accessing of certain&nbsp;registers.</p>
<p><strong>Impact:</strong></p>
<p>If using an unfused part, the platform&#8217;s overall security will be&nbsp;decreased.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-locked</code>: device is not fused&nbsp;(failure)</li>
<li><code>locked</code>: device is fused&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.8.0]</em></p>
<p><a id="org.fwupd.hsi.PrebootDma"></a></p>
<p><a id="org.fwupd.hsi.AcpiDmar"></a></p>
<h3 id="pre-boot-dma-protection"><a href="#org.fwupd.hsi.PrebootDma">Pre-boot DMA protection</a><a class="md-anchor" href="#pre-boot-dma-protection" title="Permanent link"></a></h3>
<p>The <span class="caps">IOMMU</span> on modern systems is used to mitigate against <span class="caps">DMA</span>&nbsp;attacks.</p>
<p>All I/O for devices capable of <span class="caps">DMA</span> is mapped into a private virtual memory&nbsp;region.</p>
<p>On Intel systems the <span class="caps">ACPI</span> <span class="caps">DMAR</span> table indicated the system is configured with pre-boot <span class="caps">DMA</span> protection which eliminates some firmware&nbsp;attacks.</p>
<p>On <span class="caps">AMD</span> systems the <span class="caps">ACPI</span> <span class="caps">IVRS</span> table indicates the&nbsp;same.</p>
<p><strong>Impact:</strong></p>
<p>An attacker could connect a malicious peripheral using ThunderBolt and reboot the machine, which would allow the attacker to modify the system&nbsp;memory.</p>
<p>This would allow subverting the Secure Boot protection, and also invalidate any system&nbsp;attestation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: could not determine state&nbsp;(failure)</li>
<li><code>not-enabled</code>: was not enabled&nbsp;(failure)</li>
<li><code>enabled</code>: detected correctly&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.8.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Input%E2%80%93output_memory_management_unit"><span class="caps">IOMMU</span> Wikipedia&nbsp;Page</a></li>
<li><a href="https://www.amd.com/system/files/TechDocs/48882_IOMMU.pdf"><span class="caps">AMD</span> <span class="caps">IVRS</span>&nbsp;Specification</a></li>
</ul>
<p><strong>More&nbsp;information:</strong></p>
<p>This attribute was previously known as <code>org.fwupd.hsi.AcpiDmar</code> in 1.5.0, but was renamed in 1.8.0 to support other&nbsp;vendors.</p>
<p><a id="org.fwupd.hsi.Spi.Bioswe"></a></p>
<h3 id="bios-write-enable-bwe"><a href="#org.fwupd.hsi.Spi.Bioswe">BIOS Write Enable (BWE)</a><a class="md-anchor" href="#bios-write-enable-bwe" title="Permanent link"></a></h3>
<p>Intel hardware provides this mechanism to protect the <span class="caps">SPI</span> <span class="caps">ROM</span> chip located on the motherboard from being overwritten by the operating&nbsp;system.</p>
<p>The <code>BIOSWE</code> bit must be unset otherwise userspace can write to the <span class="caps">SPI</span>&nbsp;chip.</p>
<p><strong>Impact:</strong></p>
<p>The system firmware can be written from&nbsp;userspace.</p>
<p>This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: the <span class="caps">SPI</span> device was not found&nbsp;(failure)</li>
<li><code>enabled</code>: write enable is enabled&nbsp;(failure)</li>
<li><code>not-enabled</code>: write enable is disabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/dam/www/public/us/en/documents/datasheets/6-chipset-c200-chipset-datasheet.pdf">Intel C200&nbsp;Datasheet</a></li>
</ul>
<p><a id="org.fwupd.hsi.Spi.Ble"></a></p>
<h3 id="bios-lock-enable-ble"><a href="#org.fwupd.hsi.Spi.Ble">BIOS Lock Enable (BLE)</a><a class="md-anchor" href="#bios-lock-enable-ble" title="Permanent link"></a></h3>
<p>If the lock bit is set then System Management Interrupts (SMIs) are raised when setting <span class="caps">BIOS</span> Write&nbsp;Enable.</p>
<p>The <code>BLE</code> bit must be enabled in the <span class="caps">PCH</span> otherwise <code>BIOSWE</code> can easily be&nbsp;unset.</p>
<p><strong>Impact:</strong></p>
<p>The system firmware can be written from&nbsp;userspace.</p>
<p>This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-enabled</code>: the register is not locked&nbsp;(failure)</li>
<li><code>enabled</code>: the register is locked&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/dam/www/public/us/en/documents/datasheets/6-chipset-c200-chipset-datasheet.pdf">Intel C200&nbsp;Datasheet</a></li>
</ul>
<p><a id="org.fwupd.hsi.Spi.Descriptor"></a></p>
<h3 id="read-only-spi-descriptor"><a href="#org.fwupd.hsi.Spi.Descriptor">Read-only SPI Descriptor</a><a class="md-anchor" href="#read-only-spi-descriptor" title="Permanent link"></a></h3>
<p>The <span class="caps">SPI</span> descriptor must always be read only from all other&nbsp;regions.</p>
<p>Additionally on Intel architectures the <span class="caps">FLOCKDN</span> register must be set to prevent configuration registers in the <span class="caps">SPI</span> <span class="caps">BAR</span> from being&nbsp;changed.</p>
<p><strong>Impact:</strong></p>
<p>The system firmware can be written from userspace by changing the protected&nbsp;region.</p>
<p>This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: any region can write to the flash descriptor&nbsp;(failure)</li>
<li><code>not-locked</code>: the <span class="caps">SPI</span> <span class="caps">BAR</span> is not locked&nbsp;(failure)</li>
<li><code>locked</code>: the <span class="caps">SPI</span> <span class="caps">BAR</span> is locked and read only from all regions&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.6.0]</em></p>
<p><a id="org.fwupd.hsi.Spi.SmmBwp"></a></p>
<h3 id="smm-bios-write-protect-smm_bwp"><a href="#org.fwupd.hsi.Spi.SmmBwp">SMM Bios Write Protect (SMM_BWP)</a><a class="md-anchor" href="#smm-bios-write-protect-smm_bwp" title="Permanent link"></a></h3>
<p>This bit set defines when the <span class="caps">BIOS</span> region can be written by the&nbsp;host.</p>
<p>The <code>SMM_BWP</code> bit must be set to make the <span class="caps">BIOS</span> region non-writable unless all processors are in system management&nbsp;mode.</p>
<p><strong>Impact:</strong></p>
<p>The system firmware can be written from userspace by exploiting a race condition in checking <code>BLE</code>.</p>
<p>This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-locked</code>: the region is not locked&nbsp;(failure)</li>
<li><code>locked</code>: the region is locked&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/dam/www/public/us/en/documents/datasheets/6-chipset-c200-chipset-datasheet.pdf">Intel C200&nbsp;Datasheet</a></li>
</ul>
<p><a id="org.fwupd.hsi.SupportedCpu"></a></p>
<h3 id="supported-cpu"><a href="#org.fwupd.hsi.SupportedCpu">Supported CPU</a><a class="md-anchor" href="#supported-cpu" title="Permanent link"></a></h3>
<p>Most platform checks are specific to the <span class="caps">CPU</span>&nbsp;vendor.</p>
<p>To avoid giving a very high <span class="caps">HSI</span> result for a platform we do not know how to verify, we include this attribute to ensure that the result is&nbsp;meaningful.</p>
<p><strong>Impact:</strong></p>
<p>If using an unsupported <span class="caps">CPU</span> then fwupd is unable to verify the platform&nbsp;security.</p>
<p>You should contact your platform vendor and ask them to contribute <span class="caps">HSI</span> tests for this <span class="caps">CPU</span>&nbsp;type.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>unknown</code>: platform security is unknown&nbsp;(failure)</li>
<li><code>valid</code>: the <span class="caps">CPU</span> platform is supported and has <span class="caps">HSI</span> tests&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.8.0]</em></p>
<p><a id="org.fwupd.hsi.SuspendToIdle"></a></p>
<h3 id="suspend-to-idle"><a href="#org.fwupd.hsi.SuspendToIdle">Suspend-to-Idle</a><a class="md-anchor" href="#suspend-to-idle" title="Permanent link"></a></h3>
<p>The platform should be set up with Suspend-to-Idle as the default S3 sleep&nbsp;state.</p>
<p><strong>Impact:</strong></p>
<p>A local attacker could overwrite the S3 resume script to modify system <span class="caps">RAM</span> which can lead to privilege&nbsp;escalation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: deep sleep enabled&nbsp;(failure)</li>
<li><code>not-valid</code>: could not determine the default&nbsp;(failure)</li>
<li><code>not-enabled</code>: suspend-to-idle being used&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.SuspendToRam"></a></p>
<h3 id="suspend-to-ram-disabled"><a href="#org.fwupd.hsi.SuspendToRam">Suspend to RAM disabled</a><a class="md-anchor" href="#suspend-to-ram-disabled" title="Permanent link"></a></h3>
<p>Suspend to Ram (S3) keeps the raw contents of the <span class="caps">DRAM</span> refreshed when the system is&nbsp;asleep.</p>
<p>This means that the memory modules can be physically removed and the contents recovered, or a cold boot attack can be performed with a <span class="caps">USB</span>&nbsp;device.</p>
<p>The firmware should be configured to prefer using suspend to idle instead of suspend to ram or to not offer suspend to <span class="caps">RAM</span>.</p>
<p><strong>Impact:</strong></p>
<p>An attacker with physical access to a system can obtain the un-encrypted contents of the <span class="caps">RAM</span> by suspending the machine, removing the <span class="caps">DIMM</span> and inserting it into another machine with modified <span class="caps">DRAM</span> controller before the memory contents&nbsp;decay.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: sleep enabled&nbsp;(failure)</li>
<li><code>not-valid</code>: could not determine the default&nbsp;(failure)</li>
<li><code>not-enabled</code>: suspend-to-ram being used&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-3 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Cold_boot_attack">Cold Boot Attack Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Tpm.EmptyPcr"></a></p>
<h3 id="empty-pcr-in-tpm"><a href="#org.fwupd.hsi.Tpm.EmptyPcr">Empty PCR in TPM</a><a class="md-anchor" href="#empty-pcr-in-tpm" title="Permanent link"></a></h3>
<p>The system firmware is responsible for measuring values about its boot stage in PCRs 0 through&nbsp;7.</p>
<p>Some firmwares have bugs that prevent them from measuring some of those values, breaking the fundamental assumption of the Measured Boot&nbsp;chain-of-trust.</p>
<p><strong>Impact:</strong></p>
<p>A local attacker could measure fake values into the empty <span class="caps">PCR</span>, corresponding to a firmware and <span class="caps">OS</span> that do not match the ones actually&nbsp;loaded.</p>
<p>This allows hiding a compromised boot chain or fooling a remote-attestation server into believing that a different kernel is&nbsp;running.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: no <span class="caps">TPM</span> hardware could be found&nbsp;(failure)</li>
<li><code>not-valid</code>: at least one empty checksum has been found&nbsp;(failure)</li>
<li><code>valid</code>: all PCRs from 0 to 7 must have non-empty measurements&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.7.2]</em></p>
<p><strong>Issues:</strong></p>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-42299"><span class="caps">CVE</span>-2021-42299</a></li>
</ul>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://github.com/google/security-research/blob/master/pocs/bios/tpm-carte-blanche/writeup.md"><span class="caps">TPM</span> Carte&nbsp;Blanche</a></li>
</ul>
<p><a id="org.fwupd.hsi.Tpm.ReconstructionPcr0"></a></p>
<h3 id="pcr0-tpm-event-log-reconstruction"><a href="#org.fwupd.hsi.Tpm.ReconstructionPcr0">PCR0 TPM Event Log Reconstruction</a><a class="md-anchor" href="#pcr0-tpm-event-log-reconstruction" title="Permanent link"></a></h3>
<p>The <span class="caps">TPM</span> event log records which events are registered for the <span class="caps">PCR0</span>&nbsp;hash.</p>
<p>When reconstructed the event log values should always match the <span class="caps">TPM</span> <span class="caps">PCR0</span>.</p>
<p>If extra events are included in the event log, or some are missing, the reconstitution will&nbsp;fail.</p>
<p><strong>Impact:</strong></p>
<p>This is not a vulnerability per-se, but it shows that the system firmware checksum cannot be verified as the <span class="caps">PCR</span> result has been calculated&nbsp;incorrectly.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: could not reconstitute the hash value&nbsp;(failure)</li>
<li><code>not-found</code>: no <span class="caps">TPM</span> hardware could be found&nbsp;(failure)</li>
<li><code>valid</code>: all correct&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-2 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.kernel.org/doc/html/latest/security/tpm/tpm_event_log.html">Linux Kernel <span class="caps">TPM</span>&nbsp;Documentation</a></li>
</ul>
<p><strong>More&nbsp;information:</strong></p>
<p>Additional information about specific bugs and debugging steps are available here https://github.com/fwupd/fwupd/wiki/<span class="caps">TPM</span>-<span class="caps">PCR0</span>-differs-from-reconstruction</p>
<p><a id="org.fwupd.hsi.Tpm.Version20"></a></p>
<h3 id="tpm-20-present"><a href="#org.fwupd.hsi.Tpm.Version20">TPM 2.0 Present</a><a class="md-anchor" href="#tpm-20-present" title="Permanent link"></a></h3>
<p>A <span class="caps">TPM</span> securely stores platform specific secrets that can only be divulged to trusted consumers in a secure&nbsp;environment.</p>
<p><strong>Impact:</strong></p>
<p>The <span class="caps">PCR</span> registers will not be available for use by the bootloader and&nbsp;kernel.</p>
<p>This means userspace cannot either encrypt disks to the specific machine, and also can&#8217;t know if the system firmware was externally&nbsp;modified.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: no <span class="caps">TPM</span> device found&nbsp;(failure)</li>
<li><code>not-enabled</code>: <span class="caps">TPM</span> not in v2 mode&nbsp;(failure)</li>
<li><code>found</code>: <span class="caps">TPM</span> device found in v2 mode&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Trusted_Platform_Module"><span class="caps">TPM</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Uefi.Pk"></a></p>
<h3 id="uefi-pk"><a href="#org.fwupd.hsi.Uefi.Pk">UEFI PK</a><a class="md-anchor" href="#uefi-pk" title="Permanent link"></a></h3>
<p><span class="caps">UEFI</span> defines a platform key for the&nbsp;system.</p>
<p>This should not be a test key, e.g. <code>DO NOT TRUST - AMI Test PK</code></p>
<p><strong>Impact:</strong></p>
<p>It is possible to sign an <span class="caps">EFI</span> binary with the test platform key, which invalidates the Secure Boot trust&nbsp;chain.</p>
<p>It effectively gives the local attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: an invalid key has been enrolled&nbsp;(failure)</li>
<li><code>valid</code>: valid key&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://wiki.ubuntu.com/UEFI/SecureBoot/Testing">Ubuntu SecureBoot Wiki&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Uefi.SecureBoot"></a></p>
<h3 id="uefi-secureboot"><a href="#org.fwupd.hsi.Uefi.SecureBoot">UEFI SecureBoot</a><a class="md-anchor" href="#uefi-secureboot" title="Permanent link"></a></h3>
<p><span class="caps">UEFI</span> Secure boot is a verification mechanism for ensuring that code launched by firmware is&nbsp;trusted.</p>
<p>Secure Boot requires that each binary loaded at boot is validated against trusted&nbsp;certificates.</p>
<p><strong>Impact:</strong></p>
<p>When Secure Boot is not enabled any <span class="caps">EFI</span> binary can be run at startup, which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: support has not been detected&nbsp;(failure)</li>
<li><code>not-enabled</code>: detected, but has been turned off&nbsp;(failure)</li>
<li><code>enabled</code>: supported and enabled&nbsp;(success)</li>
</ul>
<p>A test success result is needed to meet <span class="caps">HSI</span>-1 on systems that run this test. <em>[v1.5.0]</em></p>
<p><strong>Resolution:</strong> Turn off <span class="caps">CSM</span> boot and enable Secure Boot in the <span class="caps">BIOS</span>&nbsp;setup.</p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://wiki.ubuntu.com/UEFI/SecureBoot">Ubuntu SecureBoot Wiki&nbsp;Page</a></li>
</ul>
<p><a id="conclusions"></a></p>
<h2 id="conclusion"><a href="#conclusions">Conclusion</a><a class="md-anchor" href="#conclusion" title="Permanent link"></a></h2>
<p>Any system with a Host Security <span class="caps">ID</span> of <code>0</code> can easily be modified from userspace.
PCs with confidential documents should have a <code>HSI:3</code> or higher level of protection.
In a graphical tool that would show details about the computer (such as <span class="caps">GNOME</span> Control Center&#8217;s details tab) the <span class="caps">OS</span> could display a field indicating Host Security <span class="caps">ID</span>.
The <span class="caps">ID</span> should be shown with an alert color if the security is not at least <code>HSI:1</code> or the suffix is <code>!</code>.</p>
<p>On Linux <code>fwupd</code> is used to enumerate and update firmware.
It exports a property <code>HostSecurityId</code> and a <code>GetHostSecurityAttrs()</code> method.
The attributes are supposed to represent the <em>system as a whole</em> but individual (internal) devices are able to make a claim that they worsened the state of the security of the system.
Certain attributes can &#8220;obsolete&#8221; other attributes.
An example is BIOSGuard will set obsoletes to <code>org.intel.prx</code>.</p>
<p>A plugin method gets called on each plugin which adds attributes directly from the hardware or kernel.
Several attributes may be dependent upon the kernel performing measurements and it will take time for these to be upstreamed.
In some cases security level measurements will only be possible on systems with a newer&nbsp;kernel.</p>
<p>The long term goal is to increase the <code>HSI:x</code> level of systems being sold to consumers.
By making some of the <code>HSI:x</code> attributes part of the <span class="caps">LVFS</span> uploaded report we can allow users to compare vendors and models before purchasing&nbsp;hardware.</p>
<p><a id="ommissions"></a></p>
<h2 id="intentional-omissions"><a href="#ommissions">Intentional Omissions</a><a class="md-anchor" href="#intentional-omissions" title="Permanent link"></a></h2>
<h3 id="intel-sgx">Intel SGX<a class="md-anchor" href="#intel-sgx" title="Permanent link"></a></h3>
<p>This is not widely used as it has several high severity security&nbsp;issues.</p>
<h3 id="intel-mpx">Intel MPX<a class="md-anchor" href="#intel-mpx" title="Permanent link"></a></h3>
<p><span class="caps">MPX</span> support was removed from <span class="caps">GCC</span> and the Linux kernel in 2019 and it is now considered&nbsp;obsolete.</p>
<h2 id="further-work">Further Work<a class="md-anchor" href="#further-work" title="Permanent link"></a></h2>
<p>More internal and external devices should be factored into the security equation.
For now the focus for further tests should be around internal device firmware as it is what can be most directly controlled by fwupd and the hardware&nbsp;manufacturer.</p>
<p>Security conscious manufacturers are actively participating in the development of future initiatives in the Trusted Computing Group (<span class="caps">TCG</span>).
As those become ratified standards that are available in hardware, there are opportunities for synergy with this&nbsp;specification.</p>
    </div>
  </section>
</section>


    
<div id="toc" class="toc">
  <nav aria-labelledby="toc-title">
    <p id="toc-title">Content</p>
    <ul class="toc-list">
      
        
        <li class="toc-list-item"><a href="#introduction"><span class="link-text">Introduction</span></a></li>
          
          <ul class="toc-list">
          
            <li class="toc-list-item"><a href="#other-tools"><span class="link-text">Other Tools</span></a></li>
          
          </ul>
          
        
        <li class="toc-list-item"><a href="#verifying-host-firmware-security"><span class="link-text">Verifying Host Firmware Security</span></a></li>
          
        
        <li class="toc-list-item"><a href="#runtime-behavior"><span class="link-text">Runtime Behavior</span></a></li>
          
          <ul class="toc-list">
          
            <li class="toc-list-item"><a href="#hsi0-insecure-state"><span class="link-text">HSI:0 (Insecure State)</span></a></li>
          
            <li class="toc-list-item"><a href="#hsi1-critical-state"><span class="link-text">HSI:1 (Critical State)</span></a></li>
          
            <li class="toc-list-item"><a href="#hsi2-risky-state"><span class="link-text">HSI:2 (Risky State)</span></a></li>
          
            <li class="toc-list-item"><a href="#hsi3-protected-state"><span class="link-text">HSI:3 (Protected State)</span></a></li>
          
            <li class="toc-list-item"><a href="#hsi4-secure-state"><span class="link-text">HSI:4 (Secure State)</span></a></li>
          
            <li class="toc-list-item"><a href="#hsi5-secure-proven-state"><span class="link-text">HSI:5 (Secure Proven State)</span></a></li>
          
            <li class="toc-list-item"><a href="#hsi-runtime-suffix"><span class="link-text">HSI Runtime Suffix !</span></a></li>
          
          </ul>
          
        
        <li class="toc-list-item"><a href="#low-security-level"><span class="link-text">Low Security Level</span></a></li>
          
        
        <li class="toc-list-item"><a href="#not-enough-information"><span class="link-text">Not enough information</span></a></li>
          
        
        <li class="toc-list-item"><a href="#tests-included-in-fwupd"><span class="link-text">Tests included in fwupd</span></a></li>
          
          <ul class="toc-list">
          
            <li class="toc-list-item"><a href="#amd-rollback-protection"><span class="link-text">AMD Rollback protection</span></a></li>
          
            <li class="toc-list-item"><a href="#amd-spi-write-protections"><span class="link-text">AMD SPI Write protections</span></a></li>
          
            <li class="toc-list-item"><a href="#amd-spi-replay-protections"><span class="link-text">AMD SPI Replay protections</span></a></li>
          
            <li class="toc-list-item"><a href="#dram-memory-encryption"><span class="link-text">DRAM memory encryption</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-bootguard-acm"><span class="link-text">Intel BootGuard: ACM</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-bootguard-enabled"><span class="link-text">Intel BootGuard: Enabled</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-bootguard-otp"><span class="link-text">Intel BootGuard: OTP</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-bootguard-policy"><span class="link-text">Intel BootGuard: Policy</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-bootguard-verified"><span class="link-text">Intel BootGuard: Verified</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-cet-active"><span class="link-text">Intel CET: Active</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-cet-available"><span class="link-text">Intel CET: Available</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-smap"><span class="link-text">Intel SMAP</span></a></li>
          
            <li class="toc-list-item"><a href="#dma-protection"><span class="link-text">DMA protection</span></a></li>
          
            <li class="toc-list-item"><a href="#kernel-lockdown"><span class="link-text">Kernel Lockdown</span></a></li>
          
            <li class="toc-list-item"><a href="#kernel-tainted"><span class="link-text">Kernel Tainted</span></a></li>
          
            <li class="toc-list-item"><a href="#me-bootguard-platform-key"><span class="link-text">ME BootGuard Platform Key</span></a></li>
          
            <li class="toc-list-item"><a href="#me-not-in-manufacturing-mode"><span class="link-text">ME not in manufacturing mode</span></a></li>
          
            <li class="toc-list-item"><a href="#me-flash-descriptor-override"><span class="link-text">ME Flash Descriptor Override</span></a></li>
          
            <li class="toc-list-item"><a href="#csme-version"><span class="link-text">CSME Version</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-dci"><span class="link-text">Intel DCI</span></a></li>
          
            <li class="toc-list-item"><a href="#part-is-debug-locked"><span class="link-text">Part is debug locked</span></a></li>
          
            <li class="toc-list-item"><a href="#part-is-fused"><span class="link-text">Part is fused</span></a></li>
          
            <li class="toc-list-item"><a href="#pre-boot-dma-protection"><span class="link-text">Pre-boot DMA protection</span></a></li>
          
            <li class="toc-list-item"><a href="#bios-write-enable-bwe"><span class="link-text">BIOS Write Enable (BWE)</span></a></li>
          
            <li class="toc-list-item"><a href="#bios-lock-enable-ble"><span class="link-text">BIOS Lock Enable (BLE)</span></a></li>
          
            <li class="toc-list-item"><a href="#read-only-spi-descriptor"><span class="link-text">Read-only SPI Descriptor</span></a></li>
          
            <li class="toc-list-item"><a href="#smm-bios-write-protect-smm_bwp"><span class="link-text">SMM Bios Write Protect (SMM_BWP)</span></a></li>
          
            <li class="toc-list-item"><a href="#supported-cpu"><span class="link-text">Supported CPU</span></a></li>
          
            <li class="toc-list-item"><a href="#suspend-to-idle"><span class="link-text">Suspend-to-Idle</span></a></li>
          
            <li class="toc-list-item"><a href="#suspend-to-ram-disabled"><span class="link-text">Suspend to RAM disabled</span></a></li>
          
            <li class="toc-list-item"><a href="#empty-pcr-in-tpm"><span class="link-text">Empty PCR in TPM</span></a></li>
          
            <li class="toc-list-item"><a href="#pcr0-tpm-event-log-reconstruction"><span class="link-text">PCR0 TPM Event Log Reconstruction</span></a></li>
          
            <li class="toc-list-item"><a href="#tpm-20-present"><span class="link-text">TPM 2.0 Present</span></a></li>
          
            <li class="toc-list-item"><a href="#uefi-pk"><span class="link-text">UEFI PK</span></a></li>
          
            <li class="toc-list-item"><a href="#uefi-secureboot"><span class="link-text">UEFI SecureBoot</span></a></li>
          
          </ul>
          
        
        <li class="toc-list-item"><a href="#conclusion"><span class="link-text">Conclusion</span></a></li>
          
        
        <li class="toc-list-item"><a href="#intentional-omissions"><span class="link-text">Intentional Omissions</span></a></li>
          
          <ul class="toc-list">
          
            <li class="toc-list-item"><a href="#intel-sgx"><span class="link-text">Intel SGX</span></a></li>
          
            <li class="toc-list-item"><a href="#intel-mpx"><span class="link-text">Intel MPX</span></a></li>
          
          </ul>
          
        
        <li class="toc-list-item"><a href="#further-work"><span class="link-text">Further Work</span></a></li>
          
        
      
    </ul>
  </nav>
</div>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>