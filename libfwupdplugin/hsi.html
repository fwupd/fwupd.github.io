<!--
SPDX-FileCopyrightText: 2021 GNOME Foundation

SPDX-License-Identifier: Apache-2.0 OR GPL-3.0-or-later
-->

<!--
SPDX-FileCopyrightText: 2021 GNOME Foundation

SPDX-License-Identifier: Apache-2.0 OR GPL-3.0-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>FwupdPlugin &ndash; 1.0: Host Security ID Specification</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="org.freedesktop.fwupd.svg"/>
  <meta property="og:image:alt" content="FwupdPlugin-1.0"/>
  

  
  <meta property="og:title" content="FwupdPlugin: Host Security ID Specification"/>
  <meta property="og:description" content="Reference for FwupdPlugin-1.0: Host Security ID Specification"/>
  <meta name="twitter:title" content="FwupdPlugin: Host Security ID Specification"/>
  <meta name="twitter:description" content="Reference for FwupdPlugin-1.0: Host Security ID Specification"/>


  
  <meta name="twitter:card" content="summary"/>

  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap_fwupdplugin.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>
  <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <img src="org.freedesktop.fwupd.svg" class="logo"/>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">FwupdPlugin</a></h3>
        <p>API Version: 1.0</p>
        
        <p>Library Version: 1.7.5</p>
        
      </div>
      
      
    </nav>
    
    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  <section>
    <div class="docblock">
    <p><strong><span class="caps">WARNING</span>:
This specification is still in active development: it is incomplete, subject to change, and may have errors; use this at your own risk.
It is based on publicly available&nbsp;information.</strong></p>
<p>Authors:</p>
<ul>
<li>Richard&nbsp;Hughes</li>
<li>Mario&nbsp;Limonciello</li>
<li>Alex&nbsp;Bazhaniuk</li>
<li>Alex&nbsp;Matrosov</li>
</ul>
<hr />
<h2 id="introduction">Introduction<a class="md-anchor" href="#introduction" title="Permanent link"></a></h2>
<p>Not all system vendors prioritize building a secure platform.
The truth is that <strong>security costs money</strong>.
Vendors have to choose between saving a few cents on a bill-of-materials by sharing a <span class="caps">SPI</span> chip, or correctly implementing BootGuard.
Discovering security vulnerabilities often takes an external researcher filing a disclosure.
These disclosures are often technical in nature and difficult for an average consumer to&nbsp;decipher.</p>
<p>The Linux Vendor Firmware Service (<span class="caps">LVFS</span>) could provide some <strong>easy-to-understand</strong> information to people buying hardware.
The service already knows a huge amount of information about machines from signed reports uploaded to the <span class="caps">LVFS</span> and from analyzing firmware binaries.
However this information alone does not explain firmware security to the user in a way they can actually&nbsp;interpret.</p>
<h3 id="other-tools">Other Tools<a class="md-anchor" href="#other-tools" title="Permanent link"></a></h3>
<p>Traditionally, figuring out the true security of your hardware and firmware requires sifting through the marketing documentation provided by the <span class="caps">OEM</span> and in many cases just &#8220;trusting&#8221; they did it right.
Tools such as Chipsec can check the hardware configuration, but they do not work out of the box and use technical jargon that an average user cannot interpret.
Unfortunately, running a tool like Chipsec requires that you actively turn off some security layers such as <span class="caps">UEFI</span> Secure Boot, and allow 3rd party unsigned kernel modules to be&nbsp;loaded.</p>
<p><a id="verifying"></a></p>
<h2 id="verifying-host-firmware-security"><a href="#verifying">Verifying Host Firmware Security</a><a class="md-anchor" href="#verifying-host-firmware-security" title="Permanent link"></a></h2>
<p>To start out some core protections must be assigned a relative
importance.
Then an evaluation must be done to determine how each vendor is conforming to the model.
For instance, a user might say that for home use any hardware the bare minimum security level (<code>HSI:1</code>) is <em>good enough</em>.
For a work laptop the company <span class="caps">IT</span> department might restrict the choice of models to anything meeting the criteria of level <code>HSI:2</code> or above.
A journalist or a security researcher would only buy level <code>HSI:3</code> and above.
The reality is that <code>HSI:4</code> is going to be more expensive than some unbranded hardware that is rated <code>HSI:0</code>.</p>
<p>To be trusted, this rating information should be distributed in a centralized agnostic database such as the <span class="caps">LVFS</span>.</p>
<p>Of course, tools need to detect implementation errors, and to verify that the model that is measured does indeed match the <span class="caps">HSI</span> level advertised by the <span class="caps">LVFS</span>.
Some existing compliance solutions place the burden on the <span class="caps">OEM</span> to define what firmware security has been implemented, which is easy to get wrong and in some cases impossible to&nbsp;verify.</p>
<p>For this reason <span class="caps">HSI</span> will only measure security protections that can be verified by the end user without requiring any extra hardware to be connected, additional software to be installed, or disabling any existing security layers to&nbsp;measure.</p>
<p>The <span class="caps">HSI</span> specification is primarily designed for laptop and desktop hardware, although some tests <em>may</em> still make sense on server or embedded hardware.
It is not expected that non-consumer hardware will publish an <span class="caps">HSI</span>&nbsp;number.</p>
<p><a id="runtime-behaviour"></a></p>
<h2 id="runtime-behavior"><a href="#runtime-behaviour">Runtime Behavior</a><a class="md-anchor" href="#runtime-behavior" title="Permanent link"></a></h2>
<p>Orthogonal to the security features provided by the firmware there are other security considerations related to the firmware which may require internet access to discover or that runtime <span class="caps">OS</span> changes directly affect the security of the firmware.
It would not make sense to have <em>have updates on the <span class="caps">LVFS</span></em> as a requirement for a specific security level as this would mean offline the platform might be a higher level initially but as soon as it is brought online it is downgraded which would be really confusing to users.
The <em>core</em> security level will not change at Operating System runtime, but the suffix&nbsp;may.</p>
<p><a id="hsi-level0"></a></p>
<h3 id="hsi0-insecure-state"><a href="#hsi-level0">HSI:0 (Insecure State)</a><a class="md-anchor" href="#hsi0-insecure-state" title="Permanent link"></a></h3>
<p>Limited firmware&nbsp;protection.</p>
<p>The lowest security level with little or no detected firmware protections.
This is the default security level if no tests can be run or some tests in the next security level have&nbsp;failed.</p>
<p><a id="hsi-level1"></a></p>
<h3 id="hsi1-critical-state"><a href="#hsi-level1">HSI:1 (Critical State)</a><a class="md-anchor" href="#hsi1-critical-state" title="Permanent link"></a></h3>
<p>Basic protection but any failure would lead to a critical security&nbsp;impact.</p>
<p>This security level corresponds to the most basic of security protections considered essential by security professionals.
Any failures at this level would have critical security impact and could likely be used to compromise the system firmware without physical&nbsp;access.</p>
<p><a id="hsi-level2"></a></p>
<h3 id="hsi2-risky-state"><a href="#hsi-level2">HSI:2 (Risky State)</a><a class="md-anchor" href="#hsi2-risky-state" title="Permanent link"></a></h3>
<p>The failure is only happened by the theoretical exploit in the&nbsp;lab.</p>
<p>This security level corresponds to firmware security issues that pose a theoretical concern or where any exploit would be difficult or impractical to use.
At this level various technologies may be employed to protect the boot process from modification by an attacker with local access to the&nbsp;machine.</p>
<p><a id="hsi-level3"></a></p>
<h3 id="hsi3-protected-state"><a href="#hsi-level3">HSI:3 (Protected State)</a><a class="md-anchor" href="#hsi3-protected-state" title="Permanent link"></a></h3>
<p>The system firmware only has few minor issues which do not affect the security&nbsp;status.</p>
<p>This security level corresponds to out-of-band protection of the system firmware perhaps including&nbsp;recovery.</p>
<p><a id="hsi-level4"></a></p>
<h3 id="hsi4-secure-state"><a href="#hsi-level4">HSI:4 (Secure State)</a><a class="md-anchor" href="#hsi4-secure-state" title="Permanent link"></a></h3>
<p>The system is in a robust secure&nbsp;state.</p>
<p>The system is corresponding several kind of encryption and execution protection for the system&nbsp;firmware.</p>
<p><a id="hsi-level5"></a></p>
<h3 id="hsi5-secure-proven-state"><a href="#hsi-level5">HSI:5 (Secure Proven State)</a><a class="md-anchor" href="#hsi5-secure-proven-state" title="Permanent link"></a></h3>
<p>This security level corresponds to out-of-band attestation of the system firmware.
There are currently no tests implemented for <span class="caps">HSI</span>:5 and so this security level cannot yet be&nbsp;obtained.</p>
<p><a id="runtime-bang"></a></p>
<h3 id="hsi-runtime-suffix"><a href="#runtime-bang">HSI Runtime Suffix <code>!</code></a><a class="md-anchor" href="#hsi-runtime-suffix" title="Permanent link"></a></h3>
<p>A runtime security issue&nbsp;detected.</p>
<ul>
<li>
<p><span class="caps">UEFI</span> <a href="https://wiki.ubuntu.com/UEFI/SecureBoot">Secure Boot</a> has been turned off. <em>[v1.5.0]</em></p>
</li>
<li>
<p>The kernel is <a href="https://www.kernel.org/doc/html/latest/admin-guide/tainted-kernels.html">tainted</a> due to a non-free module or critical firmware issue. <em>[v1.5.0]</em></p>
</li>
<li>
<p>The kernel is not <a href="https://mjg59.dreamwidth.org/50577.html">locked down</a>. <em>[v1.5.0]</em></p>
</li>
<li>
<p>Unencrypted <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Swap_encryption">swap partition</a>. <em>[v1.5.0]</em></p>
</li>
<li>
<p>The installed fwupd is running with <a href="https://github.com/fwupd/fwupd/tree/main/plugins">custom or modified plugins</a>. <em>[v1.5.0]</em></p>
</li>
</ul>
<p><a id="tests"></a></p>
<h2 id="tests-included-in-fwupd"><a href="#tests">Tests included in fwupd</a><a class="md-anchor" href="#tests-included-in-fwupd" title="Permanent link"></a></h2>
<p>The set of tests is currently x86 <span class="caps">UEFI</span>-centric, but will be expanded in the future for various <span class="caps">ARM</span> or <span class="caps">RISC</span>-V firmware protections as required.
Where the requirement is architecture or processor specific it has been&nbsp;noted.</p>
<p><a id="org.fwupd.hsi.Uefi.SecureBoot"></a></p>
<h3 id="uefi-secureboot"><a href="#org.fwupd.hsi.Uefi.SecureBoot">UEFI SecureBoot</a><a class="md-anchor" href="#uefi-secureboot" title="Permanent link"></a></h3>
<p><span class="caps">UEFI</span> Secure boot is a verification mechanism for ensuring that code launched by firmware is&nbsp;trusted.</p>
<p>Secure Boot requires that each binary loaded at boot is validated against trusted&nbsp;certificates.</p>
<p><strong>Impact:</strong> When Secure Boot is not enabled any <span class="caps">EFI</span> binary can be run at startup, which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: support has not been&nbsp;detected</li>
<li><code>not-enabled</code>: detected, but has been turned&nbsp;off</li>
<li><code>enabled</code>: supported and&nbsp;enabled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on <span class="caps">UEFI</span> systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>Resolution:</strong></p>
<p>Turn off <span class="caps">CSM</span> boot and enable Secure Boot in the <span class="caps">BIOS</span>&nbsp;setup.</p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://wiki.ubuntu.com/UEFI/SecureBoot">Ubuntu SecureBoot Wiki&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Uefi.Pk"></a></p>
<h3 id="uefi-pk"><a href="#org.fwupd.hsi.Uefi.Pk">UEFI PK</a><a class="md-anchor" href="#uefi-pk" title="Permanent link"></a></h3>
<p><span class="caps">UEFI</span> defines a platform key for the system.
This should not be a test key, e.g. <code>DO NOT TRUST - AMI Test PK</code></p>
<p><strong>Impact:</strong> It is possible to sign an <span class="caps">EFI</span> binary with the test platform key, which invalidates the Secure Boot trust chain.
It effectively gives the local attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: valid&nbsp;key</li>
<li><code>not-valid</code>: an invalid key has been&nbsp;enrolled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on <span class="caps">UEFI</span> systems that run this test, the result must be <code>valid</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://wiki.ubuntu.com/UEFI/SecureBoot/Testing">Ubuntu SecureBoot Wiki&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Spi.Bioswe"></a></p>
<h3 id="bios-write-enable-bwe"><a href="#org.fwupd.hsi.Spi.Bioswe">BIOS Write Enable (BWE)</a><a class="md-anchor" href="#bios-write-enable-bwe" title="Permanent link"></a></h3>
<p>Intel hardware provides this mechanism to protect the <span class="caps">SPI</span> <span class="caps">ROM</span> chip located on the motherboard from being overwritten by the operating
system. The <code>BIOSWE</code> bit must be unset otherwise userspace can write to the <span class="caps">SPI</span>&nbsp;chip.</p>
<p><strong>Impact:</strong> The system firmware can be written from userspace.
This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-found</code>: the <span class="caps">SPI</span> device was not&nbsp;found</li>
<li><code>not-enabled</code>: write enable is&nbsp;disabled</li>
<li><code>enabled</code>: write enable is&nbsp;enabled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>not-enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/dam/www/public/us/en/documents/datasheets/6-chipset-c200-chipset-datasheet.pdf">Intel C200&nbsp;Datasheet</a></li>
</ul>
<p><a id="org.fwupd.hsi.Spi.Ble"></a></p>
<h3 id="bios-lock-enable-ble"><a href="#org.fwupd.hsi.Spi.Ble">BIOS Lock Enable (BLE)</a><a class="md-anchor" href="#bios-lock-enable-ble" title="Permanent link"></a></h3>
<p>If the lock bit is set then System Management Interrupts (SMIs) are raised when setting <span class="caps">BIOS</span> Write Enable.
The <code>BLE</code> bit must be enabled in the <span class="caps">PCH</span> otherwise <code>BIOSWE</code> can easily be&nbsp;unset.</p>
<p><strong>Impact:</strong> The system firmware can be written from userspace.
This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: the register is&nbsp;locked</li>
<li><code>not-enabled</code>: the register is not&nbsp;locked</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/dam/www/public/us/en/documents/datasheets/6-chipset-c200-chipset-datasheet.pdf">Intel C200&nbsp;Datasheet</a></li>
</ul>
<p><a id="org.fwupd.hsi.Spi.SmmBwp"></a></p>
<h3 id="smm-bios-write-protect-smm_bwp"><a href="#org.fwupd.hsi.Spi.SmmBwp">SMM Bios Write Protect (SMM_BWP)</a><a class="md-anchor" href="#smm-bios-write-protect-smm_bwp" title="Permanent link"></a></h3>
<p>This bit set defines when the <span class="caps">BIOS</span> region can be written by the host.
The <code>SMM_BWP</code> bit must be set to make the <span class="caps">BIOS</span> region non-writable unless all processors are in system management&nbsp;mode.</p>
<p><strong>Impact:</strong> The system firmware can be written from userspace by exploiting a race condition in checking <code>BLE</code>.
This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>locked</code>: the region is&nbsp;locked</li>
<li><code>not-locked</code>: the region is not&nbsp;locked</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>locked</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/dam/www/public/us/en/documents/datasheets/6-chipset-c200-chipset-datasheet.pdf">Intel C200&nbsp;Datasheet</a></li>
</ul>
<p><a id="org.fwupd.hsi.Spi.Descriptor"></a></p>
<h3 id="read-only-spi-descriptor"><a href="#org.fwupd.hsi.Spi.Descriptor">Read-only SPI Descriptor</a><a class="md-anchor" href="#read-only-spi-descriptor" title="Permanent link"></a></h3>
<p>The <span class="caps">SPI</span> descriptor must always be read only from all other regions.
Additionally on Intel architectures the <span class="caps">FLOCKDN</span> register must be set to prevent configuration registers in the <span class="caps">SPI</span> <span class="caps">BAR</span> from being&nbsp;changed.</p>
<p><strong>Impact:</strong> The system firmware can be written from userspace by changing the protected region.
This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>not-valid</code>: any region can write to the flash&nbsp;descriptor</li>
<li><code>locked</code>: the <span class="caps">SPI</span> <span class="caps">BAR</span> is locked and read only from all&nbsp;regions</li>
<li><code>not-locked</code>: the <span class="caps">SPI</span> <span class="caps">BAR</span> is not&nbsp;locked</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>locked</code>. <em>[v1.6.0]</em></p>
<p><a id="org.fwupd.hsi.Tpm.Version20"></a></p>
<h3 id="tpm-20-present"><a href="#org.fwupd.hsi.Tpm.Version20">TPM 2.0 Present</a><a class="md-anchor" href="#tpm-20-present" title="Permanent link"></a></h3>
<p>A <span class="caps">TPM</span> securely stores platform specific secrets that can only be divulged to trusted consumers in a secure&nbsp;environment.</p>
<p><strong>Impact:</strong> The <span class="caps">PCR</span> registers will not be available for use by the bootloader and kernel.
This means userspace cannot either encrypt disks to the specific machine, and also can&#8217;t know if the system firmware was externally&nbsp;modified.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>found</code>: device found in v2&nbsp;mode</li>
<li><code>not-found</code>: no device&nbsp;found</li>
<li><code>not-enabled</code>: not in v2&nbsp;mode</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>found</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Trusted_Platform_Module"><span class="caps">TPM</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Mei.ManufacturingMode"></a></p>
<h3 id="me-not-in-manufacturing-mode"><a href="#org.fwupd.hsi.Mei.ManufacturingMode">ME not in manufacturing mode</a><a class="md-anchor" href="#me-not-in-manufacturing-mode" title="Permanent link"></a></h3>
<p>There have been some unfortunate cases of the <span class="caps">ME</span> being distributed in manufacturing mode.
In manufacturing mode many features from the <span class="caps">ME</span> can be interacted with that decrease the platform&#8217;s&nbsp;security.</p>
<p><strong>Impact:</strong> If the <span class="caps">ME</span> is in manufacturing mode then any user with root access can provision the <span class="caps">ME</span> engine with new keys.
This gives them full access to the system even when the system is powered&nbsp;off.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>locked</code>: device has had manufacturing mode&nbsp;disabled</li>
<li><code>not-locked</code>: device is in manufacturing&nbsp;mode</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>locked</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://malware.news/t/intel-me-manufacturing-mode-obscured-dangers-and-their-relationship-to-apple-macbook-vulnerability-cve-2018-4251/23214"><span class="caps">ME</span> Manufacturing Mode: obscured&nbsp;dangers</a></li>
<li><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00086.html">Intel security advisory <span class="caps">SA</span>-00086</a></li>
</ul>
<p><a id="org.fwupd.hsi.Mei.OverrideStrap"></a></p>
<h3 id="me-flash-descriptor-override"><a href="#org.fwupd.hsi.Mei.OverrideStrap">ME Flash Descriptor Override</a><a class="md-anchor" href="#me-flash-descriptor-override" title="Permanent link"></a></h3>
<p>The Flash Descriptor Security Override Strap is not accessible to end users on consumer boards and Intel stresses that this is for debugging&nbsp;only.</p>
<p><strong>Impact:</strong> The system firmware can be written from userspace by changing the protected region.
This gives any attacker with root access a method to write persistent executable code to the firmware, which survives even a full disk wipe and <span class="caps">OS</span>&nbsp;reinstall.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>locked</code>: device in in normal runtime&nbsp;mode</li>
<li><code>not-locked</code>: device is in debugging&nbsp;mode</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>locked</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://chromium.googlesource.com/chromiumos/third_party/flashrom/+/master/Documentation/mysteries_intel.txt">Chromium documentation for Intel <span class="caps">ME</span></a></li>
</ul>
<p><a id="org.fwupd.hsi.Mei.Version"></a></p>
<h3 id="csme-version"><a href="#org.fwupd.hsi.Mei.Version">CSME Version</a><a class="md-anchor" href="#csme-version" title="Permanent link"></a></h3>
<p>Converged Security and Manageability Engine is a standalone management module that can manage and control some local devices without the host <span class="caps">CPU</span> involvement.
The <span class="caps">CSME</span> lives in the <span class="caps">PCH</span> and can only be updated by the <span class="caps">OEM</span> vendor.
The version of the <span class="caps">CSME</span> module can be checked to detect the most common and serious vulnerabilities: <span class="caps">CVE</span>-2017-5705, <span class="caps">CVE</span>-2017-5708, <span class="caps">CVE</span>-2017-5711, <span class="caps">CVE</span>-2017-5712, <span class="caps">CVE</span>-2017-5711, <span class="caps">CVE</span>-2017-5712, <span class="caps">CVE</span>-2017-5706, <span class="caps">CVE</span>-2017-5709, <span class="caps">CVE</span>-2017-5707 or <span class="caps">CVE</span>-2017-5710.</p>
<p><strong>Impact:</strong> Using any one of the critical vulnerabilities, a remote attacker can take full control of the system and all connected devices, even when the system is powered&nbsp;off.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: is not affected by the most critical&nbsp;CVEs</li>
<li><code>not-valid</code>: affected by one of the below&nbsp;CVEs</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>valid</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00086.html">Intel <span class="caps">CSME</span> Security Review Cumulative&nbsp;Update</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelDci.Enabled"></a></p>
<h3 id="intel-dci"><a href="#org.fwupd.hsi.IntelDci.Enabled">Intel DCI</a><a class="md-anchor" href="#intel-dci" title="Permanent link"></a></h3>
<p>Newer Intel CPUs support debugging over <span class="caps">USB3</span> via a proprietary Direct Connection Interface (<span class="caps">DCI</span>) with the use of off-the-shelf&nbsp;hardware.</p>
<p><strong>Impact:</strong> Using <span class="caps">DCI</span> an attacker with physical access to the computer has full access to all registers and memory in the system, and is able to make changes.
This makes privilege escalation from user to root possible, and also modifying <span class="caps">SMM</span> makes it possible to write to system firmware for a persistent&nbsp;backdoor.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: debugging is currently&nbsp;enabled</li>
<li><code>not-enabled</code>: debugging is not currently&nbsp;enabled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, the result must be <code>not-enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.co.uk/content/www/uk/en/support/articles/000029393/processors.html">Intel Direct Connect&nbsp;Interface</a></li>
<li><a href="https://github.com/chipsec/chipsec/blob/master/chipsec/cfg/8086/pch_4xxlp.xml#L270">Chipsec 4xxlp register&nbsp;definitions</a></li>
<li><a href="https://github.com/riscv/riscv-edk2-platforms/blob/85a50de1b459d1d6644a402081120770aa6dd8c7/Silicon/Intel/CoffeelakeSiliconPkg/Pch/Include/Register/PchRegsDci.h"><span class="caps">RISC</span>-V <span class="caps">EDK</span> <span class="caps">PCH</span> register&nbsp;definitions</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelDci.Locked"></a></p>
<h3 id="intel-dci_1"><a href="#org.fwupd.hsi.IntelDci.Locked">Intel DCI</a><a class="md-anchor" href="#intel-dci_1" title="Permanent link"></a></h3>
<p>Newer Intel CPUs support debugging over <span class="caps">USB3</span> via a proprietary Direct Connection Interface (<span class="caps">DCI</span>) with the use of off-the-shelf&nbsp;hardware.</p>
<p><strong>Impact:</strong> A local attacker with root access would be able to enable <span class="caps">DCI</span>. This would allow them full access to all registers and memory in the system, and is able to make changes.
This allows using <span class="caps">SMM</span> to write to system firmware for a persistent&nbsp;backdoor.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>locked</code>: <span class="caps">CPU</span> debugging has been&nbsp;disabled</li>
<li><code>not-locked</code>: is is still possible to enable <span class="caps">CPU</span>&nbsp;debugging</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>locked</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.intel.co.uk/content/www/uk/en/support/articles/000029393/processors.html">Intel Direct Connect&nbsp;Interface</a></li>
</ul>
<p><a id="org.fwupd.hsi.Tpm.EmptyPcr"></a></p>
<h3 id="empty-pcr-in-tpm"><a href="#org.fwupd.hsi.Tpm.EmptyPcr">Empty PCR in TPM</a><a class="md-anchor" href="#empty-pcr-in-tpm" title="Permanent link"></a></h3>
<p>The system firmware is responsible for measuring values about its boot stage in PCRs 0 through 7.
Some firmwares have bugs that prevent them from measuring some of those values, breaking the fundamental assumption of the Measured Boot&nbsp;chain-of-trust.</p>
<p><strong>Impact:</strong> A local attacker could measure fake values into the empty <span class="caps">PCR</span>, corresponding to a firmware and <span class="caps">OS</span> that do not match the ones actually loaded.
This allows hiding a compromised boot chain or fooling a remote-attestation server into believing that a different kernel is&nbsp;running.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: all&nbsp;correct</li>
<li><code>not-valid</code>: at least one empty checksum has been&nbsp;found</li>
<li><code>not-found</code>: no <span class="caps">TPM</span> hardware could be&nbsp;found</li>
</ul>
<p>To meet <span class="caps">HSI</span>-1 on systems that run this test, all PCRs from 0 to 7 in all banks must have non-empty measurements <em>[v1.7.2]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://github.com/google/security-research/blob/master/pocs/bios/tpm-carte-blanche/writeup.md"><span class="caps">CVE</span>-2021-42299: <span class="caps">TPM</span> Carte&nbsp;Blanche</a></li>
</ul>
<p><a id="org.fwupd.hsi.Tpm.ReconstructionPcr0"></a></p>
<h3 id="pcr0-tpm-event-log-reconstruction"><a href="#org.fwupd.hsi.Tpm.ReconstructionPcr0">PCR0 TPM Event Log Reconstruction</a><a class="md-anchor" href="#pcr0-tpm-event-log-reconstruction" title="Permanent link"></a></h3>
<p>The <span class="caps">TPM</span> event log records which events are registered for the <span class="caps">PCR0</span> hash.
When reconstructed the event log values should always match the <span class="caps">TPM</span> <span class="caps">PCR0</span>.
If extra events are included in the event log, or some are missing, the reconstitution will&nbsp;fail.</p>
<p><strong>Impact:</strong> This is not a vulnerability per-se, but it shows that the system firmware checksum cannot be verified as the <span class="caps">PCR</span> result has been calculated&nbsp;incorrectly.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: all&nbsp;correct</li>
<li><code>not-valid</code>: could not reconstitute the hash&nbsp;value</li>
<li><code>not-found</code>: no <span class="caps">TPM</span> hardware could be&nbsp;found</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>valid</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://www.kernel.org/doc/html/latest/security/tpm/tpm_event_log.html">Linux Kernel <span class="caps">TPM</span>&nbsp;Documentation</a></li>
</ul>
<p><a id="org.fwupd.hsi.AcpiDmar"></a></p>
<h3 id="pre-boot-dma-protection"><a href="#org.fwupd.hsi.AcpiDmar">Pre-boot DMA protection</a><a class="md-anchor" href="#pre-boot-dma-protection" title="Permanent link"></a></h3>
<p>The <span class="caps">IOMMU</span> on modern systems is used to mitigate against <span class="caps">DMA</span> attacks.
All I/O for devices capable of <span class="caps">DMA</span> is mapped into a private virtual memory region.
The <span class="caps">ACPI</span> <span class="caps">DMAR</span> table is used to set up pre-boot <span class="caps">DMA</span> protection which eliminates some firmware&nbsp;attacks.</p>
<p><strong>Impact:</strong> Without a <span class="caps">DMAR</span> table the <span class="caps">IOMMU</span> is disabled at boot.
An attacker could connect a malicious peripheral using ThunderBolt and reboot the machine, which would allow the attacker to modify the system memory.
This would allow subverting the Secure Boot protection, and also invalidate any system&nbsp;attestation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: detected&nbsp;correctly</li>
<li><code>not-valid</code>: could not determine&nbsp;state</li>
<li><code>not-enabled</code>: was not&nbsp;enabled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-3 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Input%E2%80%93output_memory_management_unit"><span class="caps">IOMMU</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Kernel.IntelBootguard"></a>
<a id="org.fwupd.hsi.IntelBootguard.Enabled"></a></p>
<h3 id="intel-bootguard-enabled"><a href="#org.fwupd.hsi.IntelBootguard.Enabled">Intel BootGuard: Enabled</a><a class="md-anchor" href="#intel-bootguard-enabled" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system manufacturer.
It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong> When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be verified.
This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: detected and&nbsp;enabled</li>
<li><code>not-enabled</code>: not detected, or detected but not&nbsp;enabled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://github.com/coreboot/coreboot/blob/master/src/soc/intel/jasperlake/include/soc/me.h">Coreboot&nbsp;documentation</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelBootguard.Verified"></a></p>
<h3 id="intel-bootguard-verified"><a href="#org.fwupd.hsi.IntelBootguard.Verified">Intel BootGuard: Verified</a><a class="md-anchor" href="#intel-bootguard-verified" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system manufacturer.
It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong> When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be verified.
This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>success</code>: verified boot&nbsp;chain</li>
<li><code>not-valid</code>: boot is not&nbsp;verified</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>success</code>. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelBootguard.Acm"></a></p>
<h3 id="intel-bootguard-acm"><a href="#org.fwupd.hsi.IntelBootguard.Acm">Intel BootGuard: ACM</a><a class="md-anchor" href="#intel-bootguard-acm" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system manufacturer.
It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong> When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be verified.
This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: <span class="caps">ACM</span>&nbsp;protected</li>
<li><code>not-valid</code>: boot is not&nbsp;verified</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>valid</code>. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelBootguard.Policy"></a></p>
<h3 id="intel-bootguard-policy"><a href="#org.fwupd.hsi.IntelBootguard.Policy">Intel BootGuard: Policy</a><a class="md-anchor" href="#intel-bootguard-policy" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system manufacturer.
It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong> The attacker can invalidate the chain of trust (subverting Secure Boot), and the user would get just a console warning and then continue to&nbsp;boot.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: error enforce policy is set to&nbsp;shutdown</li>
<li><code>not-valid</code>: policy is&nbsp;invalid</li>
</ul>
<p>To meet <span class="caps">HSI</span>-3 on systems that run this test, the result must be <code>valid</code>. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.IntelBootguard.Otp"></a></p>
<h3 id="intel-bootguard-otp"><a href="#org.fwupd.hsi.IntelBootguard.Otp">Intel BootGuard: OTP</a><a class="md-anchor" href="#intel-bootguard-otp" title="Permanent link"></a></h3>
<p>BootGuard is a processor feature that prevents the machine from running firmware images not released by the system manufacturer.
It forms a root-of-trust by fusing in cryptographic keys into the processor itself that are used to verify the Authenticated Code Modules found in the <span class="caps">SPI</span>&nbsp;flash.</p>
<p><strong>Impact:</strong> When BootGuard is not set up correctly then the chain-of-trust between the <span class="caps">CPU</span> and the bootloader can not be verified.
This would allow subverting the Secure Boot protection which gives the attacker full access to your&nbsp;hardware.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>valid</code>: <span class="caps">SOC</span> is&nbsp;locked</li>
<li><code>not-valid</code>: <span class="caps">SOC</span> is not&nbsp;locked</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>valid</code>. <em>[v1.5.0]</em></p>
<p><a id="org.fwupd.hsi.SuspendToRam"></a></p>
<h3 id="suspend-to-ram-disabled"><a href="#org.fwupd.hsi.SuspendToRam">Suspend to RAM disabled</a><a class="md-anchor" href="#suspend-to-ram-disabled" title="Permanent link"></a></h3>
<p>Suspend to Ram (S3) keeps the raw contents of the <span class="caps">DRAM</span> refreshed when the system is asleep.
This means that the memory modules can be physically removed and the contents recovered, or a cold boot attack can be performed with a <span class="caps">USB</span> device.
The firmware should be configured to prefer using suspend to idle instead of suspend to ram or to not offer suspend to <span class="caps">RAM</span>.</p>
<p><strong>Impact:</strong> An attacker with physical access to a system can obtain the un-encrypted contents of the <span class="caps">RAM</span> by suspending the machine, removing the <span class="caps">DIMM</span> and inserting it into another machine with modified <span class="caps">DRAM</span> controller before the memory contents&nbsp;decay.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: sleep&nbsp;enabled</li>
<li><code>not-enabled</code>: suspend-to-ram being&nbsp;used</li>
<li><code>not-valid</code>: could not determine the&nbsp;default</li>
</ul>
<p>To meet <span class="caps">HSI</span>-3 on systems that run this test, the result must be <code>not-enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Cold_boot_attack">Cold Boot Attack Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelCet.Enabled"></a></p>
<h3 id="intel-cet-available"><a href="#org.fwupd.hsi.IntelCet.Enabled">Intel CET: Available</a><a class="md-anchor" href="#intel-cet-available" title="Permanent link"></a></h3>
<p>Control enforcement technology is available on new Intel platforms and prevents exploits from hijacking the control-flow transfer instructions for both forward-edge (indirect call/jmp) and back-edge transfer&nbsp;(ret).</p>
<p><strong>Impact:</strong> A local or physical attacker with an existing unrelated vulnerability can use a reliable and well-known method to run arbitrary&nbsp;code.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: feature enabled by the&nbsp;platform</li>
<li><code>not-supported</code>: not&nbsp;supported</li>
</ul>
<p>To meet <span class="caps">HSI</span>-3 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf">Intel <span class="caps">CET</span> Technology&nbsp;Preview</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelCet.Active"></a></p>
<h3 id="intel-cet-active"><a href="#org.fwupd.hsi.IntelCet.Active">Intel CET: Active</a><a class="md-anchor" href="#intel-cet-active" title="Permanent link"></a></h3>
<p>Control enforcement technology is available on new Intel platforms and prevents exploits from hijacking the control-flow transfer instructions for both forward-edge (indirect call/jmp) and back-edge transfer&nbsp;(ret).</p>
<p><strong>Impact:</strong> A local or physical attacker with an existing unrelated vulnerability can use a <span class="caps">ROP</span> gadget to run arbitrary&nbsp;code.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>supported</code>: being&nbsp;used</li>
<li><code>not-supported</code>: not being used by the&nbsp;host</li>
</ul>
<p>To meet <span class="caps">HSI</span>-3 on systems that run this test, the result must be <code>supported</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf">Intel <span class="caps">CET</span> Technology&nbsp;Preview</a></li>
</ul>
<p><a id="org.fwupd.hsi.EncryptedRam"></a></p>
<h3 id="dram-memory-encryption"><a href="#org.fwupd.hsi.EncryptedRam">DRAM memory encryption</a><a class="md-anchor" href="#dram-memory-encryption" title="Permanent link"></a></h3>
<p><span class="caps">TME</span> (Intel) or <span class="caps">SME</span> (<span class="caps">AMD</span>) is used by the hardware on supported SOCs to encrypt all data on external memory buses.
It mitigates against an attacker being able to capture memory data while the system is running or to capture memory by removing a <span class="caps">DRAM</span>&nbsp;chip.</p>
<p>This encryption may be activated by either transparently via firmware configuration or by code running in the Linux&nbsp;kernel.</p>
<p><strong>Impact:</strong> A local attacker can either extract unencrypted content by attaching debug probes on the <span class="caps">DIMM</span> modules, or by removing them and inserting them into a computer with a modified <span class="caps">DRAM</span>&nbsp;controller.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>encrypted</code>: detected and&nbsp;enabled</li>
<li><code>not-encrypted</code>: detected but&nbsp;disabled</li>
<li><code>not-supported</code>: not&nbsp;available</li>
</ul>
<p>To meet <span class="caps">HSI</span>-4 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://software.intel.com/content/www/us/en/develop/blogs/intel-releases-new-technology-specification-for-memory-encryption.html">Intel <span class="caps">TME</span> Press&nbsp;Release</a></li>
<li><a href="https://en.wikichip.org/wiki/x86/sme">WikiChip <span class="caps">SME</span>&nbsp;Overview</a></li>
</ul>
<p><a id="org.fwupd.hsi.IntelSmap"></a></p>
<h3 id="supervisor-mode-access-prevention"><a href="#org.fwupd.hsi.IntelSmap">Supervisor Mode Access Prevention</a><a class="md-anchor" href="#supervisor-mode-access-prevention" title="Permanent link"></a></h3>
<p>Without Supervisor Mode Access Prevention, the supervisor code usually has full read and write access to user-space memory mappings.
This can make exploits easier to write, as it allows the kernel to access user-space memory when it did not intend&nbsp;to.</p>
<p><strong>Impact:</strong> A local or remote attacker can use a simple exploit to modify the contents of kernel memory which can lead to privilege&nbsp;escalation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: features are detected and&nbsp;enabled</li>
<li><code>not-supported</code>: not&nbsp;enabled</li>
</ul>
<p>To meet <span class="caps">HSI</span>-4 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Supervisor_Mode_Access_Prevention"><span class="caps">SMAP</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.Iommu"></a></p>
<h3 id="kernel-dma-protection"><a href="#org.fwupd.hsi.Iommu">Kernel DMA protection</a><a class="md-anchor" href="#kernel-dma-protection" title="Permanent link"></a></h3>
<p>The <span class="caps">IOMMU</span> on modern systems is used to mitigate against <span class="caps">DMA</span> attacks.
All I/O for devices capable of <span class="caps">DMA</span> is mapped into a private virtual memory region.
Common implementations are Intel <span class="caps">VT</span>-d and <span class="caps">AMD</span>-Vi.</p>
<p><strong>Impact:</strong> An attacker with inexpensive PCIe development hardware can write to system <span class="caps">RAM</span> from the ThunderBolt or Firewire ports which can lead to privilege&nbsp;escalation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: hardware detected and&nbsp;enabled</li>
<li><code>not-found</code>: hardware was not&nbsp;detected</li>
</ul>
<p>To meet <span class="caps">HSI</span>-2 on systems that run this test, the result must be <code>enabled</code>. <em>[v1.5.0]</em></p>
<p><strong>Resolution:</strong> If available, turn on <span class="caps">IOMMU</span> in the system <span class="caps">BIOS</span>. You may also have to use additional kernel boot parameters, for example <code>intel_iommu=on iommu=pt</code>.</p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Input%E2%80%93output_memory_management_unit"><span class="caps">IOMMU</span> Wikipedia&nbsp;Page</a></li>
</ul>
<p><a id="org.fwupd.hsi.SuspendToIdle"></a></p>
<h3 id="suspend-to-idle"><a href="#org.fwupd.hsi.SuspendToIdle">Suspend-to-Idle</a><a class="md-anchor" href="#suspend-to-idle" title="Permanent link"></a></h3>
<p>The platform should be set up with Suspend-to-Idle as the default S3 sleep&nbsp;state.</p>
<p><strong>Impact:</strong> A local attacker could overwrite the S3 resume script to modify system <span class="caps">RAM</span> which can lead to privilege&nbsp;escalation.</p>
<p><strong>Possible&nbsp;results:</strong></p>
<ul>
<li><code>enabled</code>: deep sleep&nbsp;enabled</li>
<li><code>not-enabled</code>: suspend-to-idle being&nbsp;used</li>
<li><code>not-valid</code>: could not determine the&nbsp;default</li>
</ul>
<p>To meet <span class="caps">HSI</span>-3 on systems that run this test, the result must be <code>not-enabled</code>. <em>[v1.5.0]</em></p>
<p><a id="conclusions"></a></p>
<h2 id="conclusion"><a href="#conclusions">Conclusion</a><a class="md-anchor" href="#conclusion" title="Permanent link"></a></h2>
<p>Any system with a Host Security <span class="caps">ID</span> of <code>0</code> can easily be modified from userspace.
PCs with confidential documents should have a <code>HSI:3</code> or higher level of protection.
In a graphical tool that would show details about the computer (such as <span class="caps">GNOME</span> Control Center&#8217;s details tab) the <span class="caps">OS</span> could display a field indicating Host Security <span class="caps">ID</span>.
The <span class="caps">ID</span> should be shown with an alert color if the security is not at least <code>HSI:1</code> or the suffix is <code>!</code>.</p>
<p>On Linux <code>fwupd</code> is used to enumerate and update firmware.
It exports a property <code>HostSecurityId</code> and a <code>GetHostSecurityAttrs()</code> method.
The attributes are supposed to represent the <em>system as a whole</em> but individual (internal) devices are able to make a claim that they worsened the state of the security of the system.
Certain attributes can &#8220;obsolete&#8221; other attributes.
An example is BIOSGuard will set obsoletes to <code>org.intel.prx</code>.</p>
<p>A plugin method gets called on each plugin which adds attributes directly from the hardware or kernel.
Several attributes may be dependent upon the kernel performing measurements and it will take time for these to be upstreamed.
In some cases security level measurements will only be possible on systems with a newer&nbsp;kernel.</p>
<p>The long term goal is to increase the <code>HSI:x</code> level of systems being sold to consumers.
By making some of the <code>HSI:x</code> attributes part of the <span class="caps">LVFS</span> uploaded report we can allow users to compare vendors and models before purchasing&nbsp;hardware.</p>
<p><a id="ommissions"></a></p>
<h2 id="intentional-omissions"><a href="#ommissions">Intentional Omissions</a><a class="md-anchor" href="#intentional-omissions" title="Permanent link"></a></h2>
<h3 id="intel-sgx">Intel SGX<a class="md-anchor" href="#intel-sgx" title="Permanent link"></a></h3>
<p>This is not widely used as it has several high severity security&nbsp;issues.</p>
<h3 id="intel-mpx">Intel MPX<a class="md-anchor" href="#intel-mpx" title="Permanent link"></a></h3>
<p><span class="caps">MPX</span> support was removed from <span class="caps">GCC</span> and the Linux kernel in 2019 and it is now considered&nbsp;obsolete.</p>
<h2 id="further-work">Further Work<a class="md-anchor" href="#further-work" title="Permanent link"></a></h2>
<p>More internal and external devices should be factored into the security equation.
For now the focus for further tests should be around internal device firmware as it is what can be most directly controlled by fwupd and the hardware&nbsp;manufacturer.</p>
<p>Security conscious manufacturers are actively participating in the development of future initiatives in the Trusted Computing Group (<span class="caps">TCG</span>).
As those become ratified standards that are available in hardware, there are opportunities for synergy with this&nbsp;specification.</p>
    </div>
  </section>
</section>


    

    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>